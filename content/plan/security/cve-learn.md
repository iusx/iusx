---
"title": "CVE learn"
"director": "My"
img: "cve-learn/1.png"
"time": "2025.06.29"
plan: "100,100"
target: 100
current: 1
displayType: "percent"
---

::book-content{:title="title" :img="img" :by="director" :plan="plan"}

:text-title{:t="CVE is my dream."}
æ—©åœ¨æˆ‘ä¸Šå°å­¦æ—¶ï¼Œå°±è§‰å¾— CVE å¾ˆå¸…ã€‚æ­¥å…¥åˆä¸­æ—¶ï¼Œåœ¨åˆä¸‰é‚£å¹´æˆ‘æ‹¿åˆ°äº†å¹¿ä¸œç”µä¿¡ IPTV çš„é€šç”¨æ¼æ´ã€‚æ­¥å…¥ç¤¾ä¼šæ—¶ï¼Œæˆ‘æ‹¿åˆ°äº† Github çš„ Bug bountyã€‚ä½†æˆ‘å§‹ç»ˆæ²¡æœ‰å»æ‹¿ä¸€ä¸ª CVE çš„ç¼–å·ã€‚å› ä¸ºæ°´æ˜¯å¯ä»¥æ°´çš„ï¼Œä½†æˆ‘å·²ç»æ°´äº† CNVD å’Œ Hackeroneï¼Œæˆ‘å¸Œæœ›æˆ‘çš„ç¬¬ä¸€ä¸ª CVE ç¼–å·å¯ä»¥æ˜¯ä¸é‚£ä¹ˆæ°´çš„ï¼Œæœ‰ä¸€ç‚¹å«é‡‘é‡çš„ã€‚

è™½ç„¶æˆ‘å¹¶ä¸æ˜¯ Security è¡Œä¸šæˆ–é¢†åŸŸçš„ä»ä¸šäººå‘˜ï¼Œåªæ˜¯ä¸€ä¸ªçˆ±å¥½è€…ã€‚ä½†æˆ‘ä¸€ç›´è§‰å¾— Security å¾ˆå¸…ã€‚åŒæ ·çš„ï¼Œè™½ç„¶æˆ‘ä¸æ˜¯ Design è¡Œä¸šçš„ä»ä¸šäººå‘˜ï¼Œä½†æˆ‘è§‰å¾—å¯ä»¥è®©è‡ªå·±åšå‡ºæ¥çš„ project ä¼šå¥½çœ‹ï¼Œæœ‰ä¸ªæ€§ã€‚

æˆ‘å¹¶ä¸æ˜¯ä¸€ä¸ªä¸“ç²¾çš„äººã€‚å¾ˆå¤šæ—¶å€™æˆ‘æ¯é¡¹æ„Ÿå…´è¶£çš„é¢†åŸŸå•æ‹å‡ºæ¥éƒ½ä¼šè¢«é™ç»´æ‰“å‡»ã€‚è™½ç„¶æˆ‘å•é¡¹é¢†åŸŸæ— æ³•åª²ç¾ä¸“ä¸šçš„ä»ä¸šè€…ï¼Œä½†æˆ‘æ„Ÿå…´è¶£çš„é¢†åŸŸéƒ½æœ‰ç‚¹å»ºæ ‘å’Œä½œå“ã€‚å°† Securityã€Designã€Animationã€Computer åˆåœ¨ä¸€èµ·ï¼Œä¸ä¹‹èƒ½åª²ç¾çš„äººå¯èƒ½ä¼šå°‘é‚£ä¹ˆä¸€ç‚¹ã€‚

è€Œç°åœ¨ï¼Œæˆ‘åªæœ‰ Design çš„ä»£è¡¨ä½œï¼Œè€Œ Securityã€Animationã€Computer è¿˜æ²¡æœ‰ä¸€ä¸ªèƒ½æ‹¿å¾—å‡ºæ‰‹çš„ä½œå“ã€‚å› æ­¤æˆ‘å¸Œæœ›ä¼šåœ¨æœªæ¥ä¸‰å¹´ï¼Œå°½å¯èƒ½çš„è¡¥å…¨è¿™äº›æˆ‘æ„Ÿå…´è¶£é¢†åŸŸçš„ä»£è¡¨ä½œã€‚å¯èƒ½å› ä¸º Work æ¯”è¾ƒé—²çš„ç¼˜æ•…ï¼Œæˆ‘çš„æ—¶é—´æ€»ä¼šå¤šé‚£ä¹ˆä¸€ç‚¹æ¥æ”¾åˆ°æˆ‘æ„Ÿå…´è¶£çš„é¢†åŸŸä¸Šã€‚å³ä½¿è¾¾ä¸åˆ°ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œè‡³å°‘ä¹Ÿæ˜¯åŠªåŠ›è¿‡äº†ï¼Œæ— è®ºå¦‚ä½•ä¸‰å¹´åçš„è‡ªå·±æ€»ä¼šæ¯”ç°åœ¨çš„è‡ªå·±ç¨å¾®å‰å®³é‚£ä¹ˆä¸€ç‚¹ç‚¹ã€‚

å› æ­¤è¿™ä¸ªé¡µé¢ä¼šè®°å½•ä¸€äº›æˆ‘æ„Ÿå…´è¶£çš„ CVE å’Œ CWE çš„ç¼–å·æ¥è®©æˆ‘å­¦ä¹ ï¼Œå¯èƒ½ä¼šè·å–åˆ°ä¸€äº›æ–°çš„æ€è·¯å’Œå¯¹æŸä¸ªæ–¹é¢çš„ç†è§£ã€‚æ¥å¸®åŠ©æˆ‘å®ç°è¿™ä¸ªç›®æ ‡ï¼Œé¡ºä¾¿çœ‹çœ‹å†·é—¨çš„ CWE æ–¹å‘ï¼Œæ¯•ç«Ÿ OWASP TOP 10 ä¸ªäººæ²¡æœ‰å¤ªå¤§çš„å…´è¶£ã€‚


---

# rust 3

## Github 3
### CVE-2022-36114 1
::cve-info{to="https://nvd.nist.gov/vuln/detail/CVE-2022-36114"}
---
cve: CVE-2022-36114
cwe: 400
type: 2
---

ä¸å—æ§åˆ¶çš„èµ„æºæ¶ˆè€—
::

åˆ©ç”¨ Cargo çš„ [build script](https://doc.rust-lang.org/cargo/reference/build-scripts.html) åœ¨æ„å»ºé˜¶æ®µç¼–è¯‘ç¬¬ä¸‰æ–¹çš„é Rust codeï¼ŒåŒæ—¶ç»“åˆ [procedural macros](https://doc.rust-lang.org/book/ch20-05-macros.html#how-to-write-a-custom-derive-macro)ï¼Œåœ¨æ‰§è¡Œ `cargo run` çš„è¿‡ç¨‹ä¸­è§¦å‘äº†ä¸€ä¸ª [Zip Bomb](https://en.wikipedia.org/wiki/Zip_bomb) è¡Œä¸ºã€‚

å¯¹äºè¿™ä¸ªé—®é¢˜çš„ä¿®å¤ï¼Œrust-lang å·²ç»ç»™å‡ºäº†ä¸€ä¸ª [è¡¥ä¸ä¿®å¤](https://github.com/rust-lang/wg-security-response/blob/4bbe734e6404ece6f4e85027564f8995d4ab70e0/patches/CVE-2022-36114/0001-CVE-2022-36114-limit-the-maximum-unpacked-size-of-a-.patch) Zip_bomb çš„é—®é¢˜:

```c
// åœ¨è§£å‹ .crate æ–‡ä»¶ï¼ˆtar.gzï¼‰æ—¶ï¼Œé™åˆ¶æœ€å¤šåªèƒ½è§£å‹å‡º 512MB çš„å†…å®¹ã€‚
+const MAX_UNPACK_SIZE: u64 = 512 * 1024 * 1024;
```

åŒæ—¶å¼•å…¥äº† `LimitErrorReader`: è¶…è¿‡å°±æŠ›å‡ºé”™è¯¯ï¼Œé¿å…èµ„æºè¢«è€—å°½ï¼ˆæ¯”å¦‚ç£ç›˜å†™çˆ†ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–å¹¶æ²¡æœ‰å¯¹ macrosã€build åŠ ä»¥é™åˆ¶ï¼Œåªæ˜¯å»ºè®®å°½å¯èƒ½çš„ç”¨ [crates](https://crates.io/) ä¸Šæäº¤çš„ crateã€‚

---

### CVE-2023-40030 1
::cve-info{to="https://nvd.nist.gov/vuln/detail/cve-2023-40030"}
---
cve: CVE-2023-40030
cwe: 79
type: 1
---

{OWASP TOP TEN}: ä¸æ°å½“çš„ç½‘é¡µç”Ÿæˆè¾“å…¥ä¸­å’Œ XSS<br>
::

çœ‹åˆ°è¿™ç¯‡é€šå‘Šçš„æ—¶å€™ï¼Œæˆ‘å°±å›æƒ³èµ·ä¸ºä»€ä¹ˆæˆ‘çœ‹ `cargo build --timings` çš„æ—¶å€™è‚¿ä¹ˆæ²¡æƒ³åˆ°ä¼šæœ‰ CWE-79ã€‚[--timings](https://doc.rust-lang.org/cargo/reference/timings.html) æ˜¯ä¸€ä¸ªç”Ÿæˆ build æ—¶é—´çš„ html æŠ¥å‘Šã€‚

å¯ä»¥é€šè¿‡åœ¨ `Cargo.toml` ä¸­åŠ å…¥ `features = ["<img src='' onerror=alert(0)"]` æ¥è§¦å‘ä¸€ä¸ª CWE-79, å› æ­¤å¯¹è¿™ä¸ªé—®é¢˜çš„ä¿®å¤å°±æ˜¯ï¼Œå°†ä¹‹å‰çš„ `Warning`, æ¢æˆäº† `bail!` æœºåˆ¶ã€‚


::text-space
---
type: tip
---
`bail!` å®æ¥è‡ª [anyhow](https://docs.rs/anyhow/latest/anyhow/macro.bail.html) ç”¨äºæ–¹ä¾¿åœ°æå‰è¿”å›é”™è¯¯ã€‚
::


å¯ä»¥çœ‹ä¸€ä¸‹ [fix pr](https://github.com/rust-lang/cargo/commit/9835622853f08be9a4b58ebe29dcec8f43b64b33#diff-99a8f4b284589e7db1aec698aa8f9ef9390f3ee3ecddc399dd6be1aa9ee00388L440-L446)ï¼Œéå¸¸æœ‰æ„æ€ï¼Œæ¯”å¦‚ `validate_feature_name` å‡½æ•°ã€‚

åŸæ¥ï¼šé‡åˆ°éæ³• feature nameï¼Œåªè¾“å‡º `warning`ï¼Œæµç¨‹ç»§ç»­ã€‚<br>

```
if let Some(ch) = chars.next() {Add commentMore actions
        if !(unicode_xid::UnicodeXID::is_xid_start(ch) || ch == '_' || ch.is_digit(10)) {
            config.shell().warn(&format!(
                "invalid character `{}` in feature `{}` in package {}, \
                the first character must be a Unicode XID start character or digit \
                (most letters or `_` or `0` to `9`)\n\
                {}",
                ch, name, pkg_id, FUTURE
            ))?;

        }
    }
```



::text-space
---
type: tip
---
æˆ‘æœ¬æ¥æƒ³çœ‹çœ‹ 2025-6-27 çš„ src/cargo/core/summary.rs è¿™ä¸ª fix pr çš„åŒºåˆ«ã€‚ä½†æˆ‘å‘ç°äº†ä¸€ä¸ªæµé‡å¯†ç ï¼Œé‚£å°±æ˜¯ Rc â†’ Arc, é—®å°±æ˜¯ Thread Safetyï¼
::

ç°åœ¨ï¼šé‡åˆ°éæ³• feature nameï¼Œç›´æ¥ `bail!`ï¼Œæ„å»ºä¸­æ­¢ï¼Œç”¨æˆ·å¿…é¡»ä¿®æ­£ã€‚

```
 if let Some(ch) = chars.next() {Add commentMore actions
        if !(unicode_xid::UnicodeXID::is_xid_start(ch) || ch == '_' || ch.is_digit(10)) {
            bail!(
                "invalid character `{}` in feature `{}` in package {}, \
                the first character must be a Unicode XID start character or digit \
                (most letters or `_` or `0` to `9`)",
                ch,
                name,
                pkg_id
            );
        }
    }
```

åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œæ¥éªŒè¯ feature name æ˜¯å¦åˆæ³•ï¼Œä¾‹å¦‚åªæœ‰ `is_ok()` æ˜¯åˆæ³•çš„ï¼Œè€Œ `is_err()` æ˜¯ä¸åˆæ³•çš„ï¼š

```
 #[test]Add commentMore actions
    fn valid_feature_names() {
        let loc = CRATES_IO_INDEX.into_url().unwrap();
        let source_id = SourceId::for_registry(&loc).unwrap();
        let pkg_id = PackageId::new("foo", "1.0.0", source_id).unwrap();

        assert!(validate_feature_name(pkg_id, "c++17").is_ok());
        assert!(validate_feature_name(pkg_id, "128bit").is_ok());
        assert!(validate_feature_name(pkg_id, "_foo").is_ok());
        assert!(validate_feature_name(pkg_id, "feat-name").is_ok());
        assert!(validate_feature_name(pkg_id, "feat_name").is_ok());
        assert!(validate_feature_name(pkg_id, "foo.bar").is_ok());

        assert!(validate_feature_name(pkg_id, "+foo").is_err());
        assert!(validate_feature_name(pkg_id, "-foo").is_err());
        assert!(validate_feature_name(pkg_id, ".foo").is_err());
        assert!(validate_feature_name(pkg_id, "foo:bar").is_err());
        assert!(validate_feature_name(pkg_id, "foo?").is_err());
        assert!(validate_feature_name(pkg_id, "?foo").is_err());
        assert!(validate_feature_name(pkg_id, "â’¶â’·â’¸").is_err());
        assert!(validate_feature_name(pkg_id, "aÂ¼").is_err());
    }
```


---

### CVE-2023-41051 1

::cve-info{to="https://nvd.nist.gov/vuln/detail/cve-2023-41051"}
---
cve: CVE-2023-51051
cwe: 125
type: 1
---
è¶Šç•Œè®¿é—®ï¼ˆout-of-boundsï¼‰: è®¿é—®äº†æœ¬ä¸å±äºè¯¥å†…å­˜åŒºåŸŸçš„æ•°æ®ã€‚
::

[vm-memory](https://github.com/rust-vmm/vm-memory) çš„ `VolatileMemory` å®ç°æœªå¯¹è¾¹ç•Œè¿›è¡Œä¸¥æ ¼æ ¡éªŒï¼Œå¯¼è‡´æœ‰å¯èƒ½è¯»å–åˆ°éæ³•çš„å†…å­˜åŒºåŸŸï¼š

1. `VolatileMemory::get_slice`: è¿”å›ä¸€æ®µâ€œæ˜“å¤±æ€§åˆ‡ç‰‡â€ï¼ˆVolatileSliceï¼‰ï¼Œç”¨äºåç»­çš„åº•å±‚æ“ä½œ
2. `VolatileMemory::read/write`: ç›´æ¥ä»è¿™å—å†…å­˜è¯»/å†™æ•°æ®ï¼Œä¿è¯æ¯æ¬¡éƒ½å®é™…å‘ç”Ÿå†…å­˜è®¿é—®

VolatileMemory trait å°±æ˜¯å®šä¹‰äº†ä¸€å¥—è®¿é—®â€œè™šæ‹Ÿæœºç‰©ç†å†…å­˜â€æˆ–â€œç‰¹æ®Šç¡¬ä»¶å†…å­˜åŒºåŸŸâ€çš„ä½å±‚æ¥å£ï¼Œä¿è¯æ¯æ¬¡è¯»å†™éƒ½çœŸå®å‘ç”Ÿï¼Œä¸”ä¸è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚å®ƒè®©ä¸åŒçš„åº•å±‚å®ç°éƒ½èƒ½ç”¨ç»Ÿä¸€çš„ trait æ“ä½œã€‚

ä½†é—®é¢˜æ¥äº†ï¼Œè¿™ä¸ªé€šå‘Šå¹¶ä¸æ¶‰åŠ `read/write`ï¼Œæ›´å¤šçš„æ˜¯ `get_slice` æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š

1. `get_atomic_ref`
2. `aligned_as_ref`
3. `aligned_as_mut`
4. `get_ref`
5. `get_array_ref`

ä¸Šè¿°æ–¹æ³•æœ‰ä¸ªå…±åŒç‚¹ï¼Œéƒ½æ˜¯åˆ©ç”¨ `ref` ç±»æ–¹æ³•å¼•èµ·çš„ã€‚å®ƒä»¬éƒ½å°è¯•è¿”å›æŒ‡å‘åº•å±‚å†…å­˜çš„ Rust ç±»å‹å¼•ç”¨ï¼ˆå¦‚ &Tã€`&[T]` ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥è¯»å†™åŸå§‹å­—èŠ‚æ•°æ®ã€‚å®ƒä»¬çš„å®ç°é€šå¸¸ä¼šè°ƒç”¨ get_sliceï¼Œå‡è®¾è¿”å›çš„å†…å­˜åŒºåŸŸé•¿åº¦è¶³å¤Ÿå¤§ã€‚

å¦‚æœè‡ªå®šä¹‰å®ç°çš„ get_slice è¿”å›çš„åˆ‡ç‰‡é•¿åº¦ä¸è¶³ï¼Œå°±ä¼šå¯¼è‡´è¿™äº› ref æ–¹æ³•äº§ç”Ÿè¶Šç•Œå¼•ç”¨ï¼Œé€ æˆå†…å­˜å®‰å…¨é£é™©ã€‚ä¾‹å¦‚ï¼š

1. è¿™äº›æ–¹æ³•å‡è®¾ get_slice è¿”å›çš„ VolatileSlice é•¿åº¦æ˜¯ä½ è¦æ±‚çš„å¤§å°ï¼ˆæ¯”å¦‚ T æ˜¯ u32ï¼Œå°±è¦ 4 å­—èŠ‚ï¼‰ã€‚
2. å¦‚æœè‡ªå®šä¹‰å®ç°çš„ get_slice è¿”å›çš„ VolatileSlice æ¯”ä½ è¦æ±‚çš„çŸ­ï¼ˆæ¯”å¦‚åªè¿”å›äº†2å­—èŠ‚ï¼‰
3. è¿™äº›æ–¹æ³•è¿˜æ˜¯ä¼šç…§å¸¸æŠŠè¿™å—å†…å­˜å¼ºè½¬æˆ &Tï¼Œè¿™æ—¶ä½ è®¿é—® &T æ—¶å°±å¯èƒ½ä¼šè¯»åˆ°è¶…å‡ºå®é™…å†…å­˜èŒƒå›´ä»¥å¤–çš„å†…å®¹

ä»”ç»†æ¬£èµ [fix pr](https://github.com/rust-vmm/vm-memory/commit/aff1dd4a5259f7deba56692840f7a2d9ca34c9c8#diff-0870facad91de878abbdf4dc43212b8de558021cf0971f62148c2cab381bd150R109-R275) ä½ ä¼šå‘ç°ï¼š

è¿™äº›æ–¹æ³•å†…éƒ¨ï¼Œéƒ½ä¼šè°ƒç”¨ `get_slice(offset, count)` æ‹¿åˆ°ä¸€å—å†…å­˜åˆ‡ç‰‡ï¼Œç„¶åæŠŠå®ƒ reinterpret_cast æˆä½ è¦çš„ç±»å‹å¼•ç”¨ã€‚å› æ­¤ç»™ `get_slice` åŠ ä¸Š `assert_eq!` å°±æ„å‘³ç€ï¼š

â€œå¦‚æœä½ è¦ 8 å­—èŠ‚å¼•ç”¨ï¼Œå¿…é¡»å®é™…æ‹¿åˆ° 8 å­—èŠ‚çš„å†…å­˜åˆ‡ç‰‡ï¼Œå¦åˆ™ç›´æ¥ panicï¼Œä¸åš unsafe æ“ä½œï¼â€

---

### CVE-2023-38497 1

::cve-info{to="https://nvd.nist.gov/vuln/detail/cve-2023-38497"}
---
cve: CVE-2023-38497
cwe: 278,732
type: 3
---
278: ä¸å®‰å…¨çš„ä¿ç•™ç»§æ‰¿æƒé™<br>
- 732: å…³é”®èµ„æºçš„æƒé™åˆ†é…é”™è¯¯
::

CWE-278 è¿˜æ˜¯è¾ƒä¸ºå†·é—¨çš„ï¼Œæ¯•ç«Ÿåªæœ‰ä¸€ä¸ªå‚è€ƒï¼Œæ—¢ [CVE-2005-1724](https://www.cve.org/CVERecord?id=CVE-2005-1724)ã€‚CWE-278 è¿™ä¸ªç±»çš„æ¼æ´å¸¸è§è¡¨ç°ä¹‹ä¸€å°±æ˜¯ **æƒé™é™åˆ¶â€**ã€‚æ€»çš„æ¥è¯´ umask æ˜¯ **é™åˆ¶æ–°å»ºæ–‡ä»¶æˆ–ç›®å½•é»˜è®¤æƒé™çš„ä¸€ä¸ªæœºåˆ¶ã€‚**ï¼Œå¯ä»¥çœ‹çœ‹ [Linuxä¸­umaskæ·±å…¥ç†è§£
](https://langzi989.github.io/2017/09/13/Linux%E4%B8%ADumash%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/)ï¼Œæˆ‘æ¸…æ™°è®°å¾—æœ‰æ—¶å€™éœ€è¦æ‰§è¡Œä»€ä¹ˆ `bash` è„šæœ¬çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ `chmod 777`, è¦ä¸ç„¶è¿è¡Œä¸äº†ã€‚

::text-space
---
type: tip
---
CVE-2005-1724 æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œé…ç½®å®‰å…¨é™åˆ¶æ— æ•ˆâ€å‹æ¼æ´ï¼Œä½¿å¾— NFS å¯¼å‡ºçš„ç›®å½•è¢«æ‰€æœ‰äººéƒ½èƒ½è®¿é—®ï¼Œé€ æˆæƒé™ç»•è¿‡å’Œæ½œåœ¨çš„æ•°æ®æ³„éœ²/ç¯¡æ”¹é£é™©ã€‚å…¶å½’ç±»äº CWE-278 **å±äºæƒé™/è®¿é—®æ§åˆ¶å¤±æ•ˆé—®é¢˜ã€‚**

è€Œ CWE-732 åˆæ˜¯ CWE-278 çš„å­ç±»ï¼Œå› æ­¤ä¼šæœ‰ä¸¤ä¸ª CWE çš„åˆ†é…ã€‚

æ¯”å¦‚ CVE-2005-1724 åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œåœ¨å¯¼å‡ºï¼ˆexportï¼‰NFS æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œé€šå¸¸ä¼šç”¨ `-network` å’Œ `-mask`ï¼š

```
/some/dir -network 192.168.1.0 -mask 255.255.255.0
```

è¿™æ ·æœ¬åº”åªæœ‰ 192.168.1.0/24 ç½‘ç»œå†…çš„ä¸»æœºå¯ä»¥è®¿é—®è¯¥ç›®å½•ã€‚ä½†åœ¨ Mac OS X 10.4.x çš„ NFS æœåŠ¡å®ç°æ²¡æœ‰æ­£ç¡®å¤„ç†/ç”Ÿæ•ˆè¿™äº›å‚æ•°ã€‚å› æ­¤æ„æˆäº† CWE-278

::

è¦æƒ³ç†è§£æœ¬æ¬¡çš„ CVEï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£æ ‡é¢˜ **Cargo åœ¨è§£å‹ crate åŒ…æ—¶æœªæŒ‰ç…§ umask é™åˆ¶æ–‡ä»¶æƒé™**ã€‚è€Œ `umask` æ˜¯é»˜è®¤æƒé™ï¼Œç¿»è¯‘æˆäººè¯å°±æ˜¯ï¼š

::text-tip{type="big"}
Cargo åœ¨è§£å‹ crate åŒ…æ—¶ï¼Œæ²¡æœ‰æŒ‰ç…§ umask åˆ†ä¸ªé»˜è®¤çš„æƒé™ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ä¹Ÿå°±æ˜¯ `777` æƒé™æ„å»ºæ”»å‡»è„šæœ¬ã€‚<br>
â†‘ å¯èƒ½ä¸æ˜¯å¾ˆä¸¥è°¨
::

è¿‡å» Cargo è§£å‹ .crate åŒ…æ—¶ï¼Œç›´æ¥é‡‡ç”¨äº†å‹ç¼©åŒ…å†…çš„æ–‡ä»¶æƒé™ï¼ˆæ¯”å¦‚ 777/666ï¼‰ï¼Œ**æ²¡æœ‰ç»“åˆæ“ä½œç³»ç»Ÿçš„ umaskï¼Œå¯¼è‡´è§£å‹åçš„æ–‡ä»¶æƒé™è¿‡å®½ï¼Œå…¶ä»–æœ¬åœ°ç”¨æˆ·å¯èƒ½èƒ½å†™å…¥ã€ç¯¡æ”¹è¿™äº›æºç æ–‡ä»¶ã€‚**

åœ¨ `src/cargo/util/mod.rs` ä¸­æ–°å¢äº† `get_umask()` å‡½æ•°ã€‚ä»¥åœ¨è§£å‹æ–‡ä»¶æ—¶ï¼Œå¼ºåˆ¶ç”¨ `umask` é™åˆ¶æ–°æ–‡ä»¶çš„æƒé™ã€‚ï¼š

```
#[cfg(unix)]
pub fn get_umask() -> u32 {
    use std::sync::OnceLock;
    static UMASK: OnceLock<libc::mode_t> = OnceLock::new();
    // SAFETY: Syscalls are unsafe. Calling `umask` twice is even unsafer for
    // multithreading program, since it doesn't provide a way to retrive the
    // value without modifications. We use a static `OnceLock` here to ensure
    // it only gets call once during the entire program lifetime.
    *UMASK.get_or_init(|| unsafe {
        let umask = libc::umask(0o022);
        libc::umask(umask);
        umask
    }) as u32 // it is u16 on macos
}
```

ä»¥åŠå¾ˆæœ‰è‰ºæœ¯æ€§çš„ä¸€è¡Œ code:

```
fs::set_permissions(path, Permissions::from_mode(final_mode)).unwrap();
```

è§£å‹ crate æ—¶ï¼Œè¯»å–æ¯ä¸ªæ–‡ä»¶çš„åŸå§‹æƒé™ï¼ˆå¦‚ 0o777ï¼‰ï¼Œå®é™…å†™å…¥ç£ç›˜æ—¶ï¼Œä¼šç”¨ åŸå§‹æƒé™ & `!umask` å¾—åˆ°æœ€ç»ˆæƒé™ï¼Œå† chmod åˆ°æ–‡ä»¶ä¸Š:

```
assert_eq!(metadata.mode() & 0o777, 0o644 & !umask);
```

---

## Polyduekes 3

:text-title{t="Polyduekes"}

åœ¨ telegram è®¤è¯†åˆ°çš„çƒ­å¿ƒç¾¤ Uï¼Œå¾—çŸ¥æˆ‘çš„ç›®æ ‡æ˜¯ Rust CVE ä¹‹åå›å¤æˆ‘äº†ä¸€ä¸ªä»–æ•´ç†è¿‡çš„åˆé›†ã€‚å¾ˆæœ‰å¤§ä½¬çš„é£èŒƒï¼Œç‰¹åˆ«æ˜¯é‚£å¥ **the rust cve part is easy, just look at the stdlib**ã€‚æ®æˆ‘è§†å¥¸è¿‡åï¼Œç¡®å®æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„å¤§ä½¬ï¼Œä¾‹å¦‚ï¼š

1. https://aur.archlinux.org/packages/pldget
2. https://git.sr.ht/~cdv/polydeukes
3. https://github.com/chrisvittal
4. https://git.sr.ht/~cdv/
5. https://chris.vittal.dev/
6. https://github.com/rust-lang/rust/commits?author=chrisvittal

::img-tip
---
url: cve-learn/2.jpg
text: ä¹‹æ‰€ä»¥èƒ½æœºç¼˜å·§åˆå¾—åˆ°å¤§ä½¬çš„è¿™å¥è¯ï¼Œæºè‡ªäºæˆ‘çœ‹åˆ°äº†é¢‘é“ä¸­è½¬å‘çš„è¿™ä¸ªè¡¨æƒ…åŒ…ï¼Œç„¶åæƒ³èµ·äº†å°å­¦æ—¶æƒ³ç”¨å®ƒæ”»å‡»å­¦æ ¡å®˜ç½‘è®©å…¶ç˜«ç—ªçš„é‚£ä¸ªä¸Šåˆã€‚<br><br>ä¸è¿‡æ”»å‡»å¹¶æ²¡æœ‰æˆåŠŸï¼Œåªæ˜¯è¿”å›äº† 503, æ¢ä¸€å°è®¾å¤‡è¿˜èƒ½ç»§ç»­è®¿é—®ï¼Œå¯èƒ½å½“æ—¶éœ€è¦é€šè¿‡ç±»ä¼¼ https://spys.one/en/ è¿™æ ·çš„ IP æ± æ‰è¡Œã€‚<br><br>æˆ‘å½“æ—¶ä¸€åº¦è®¤ä¸ºè¿™ä¸ªè½¯ä»¶æ²¡ä»€ä¹ˆç”¨ï¼Œä½†é¢‘é“çš„å¦ä¸€ä½ç®¡ç†å‘˜å›å¤æˆ‘è¯´åœ¨ä»–ä»¬é‚£ä¸ªå¹´ä»£ï¼Œä»–é€šè¿‡è¿™ä¸ªè½¯ä»¶è®©å…¶ä¸€ä¸ªè®ºå›ç˜«ç—ªæ‰äº†ã€‚<br><br>æœ‰ä¸€è¯´ä¸€åå¤šå¹´è¿‡å»äº†ï¼Œå½“æ—¶çš„ç•Œé¢å°±ç®—æ‹¿åˆ°ç°åœ¨æ¥çœ‹ä¹Ÿå¹¶ä¸è¿‡æ—¶ã€‚
---
::


```
the rust cve part is easy, just look at the stdlib 
https://www.cve.org/CVERecord?id=CVE-2024-24576
https://www.cve.org/CVERecord?id=CVE-2022-21658
https://www.cve.org/CVERecord?id=CVE-2021-31162
https://www.cve.org/CVERecord?id=CVE-2021-28879
https://www.cve.org/CVERecord?id=CVE-2021-28878
https://www.cve.org/CVERecord?id=CVE-2025-3416
```

---
### CVE-2024-24576 1

::cve-info{to="https://nvd.nist.gov/vuln/detail/cve-2024-24576"}
---
cve: CVE-2024-24576
cwe: 78,88
type: 3
---
78: æ³¨å…¥å¯ä»¥å¯¼è‡´æ‰§è¡Œä»»æ„å‘½ä»¤<br>
88: ä¸èƒ½æ‰§è¡Œæ–°å‘½ä»¤ï¼Œä½†å¯ä»¥æ³¨å…¥â€œé¢å¤–å‚æ•°â€æ”¹å˜å‘½ä»¤è¡Œä¸º
::
åœ¨ Windows ä¸­,æœ‰å¤§é‡çš„å±é™©å­—ç¬¦,ä¾‹å¦‚ `& | < > ^ % ! " ' ( ) , ; = [ ] { }` **åªéœ€ä¸€ä¸ªç¬¦å·å³å¯ç ´åä½ çš„è½¬ä¹‰æ–¹å¼**.

rust-team ç»™å‡ºçš„åº”å¯¹æ–¹æ¡ˆåˆ™æ˜¯ä½¿ç”¨ [CommandExt::raw_arg](https://doc.rust-lang.org/std/os/windows/process/trait.CommandExt.html#tymethod.raw_arg), å…¶æ ¸å¿ƒçš„å°±æ˜¯ä¸‹é¢çš„è¿™è¡Œé€»è¾‘( æ£€æŸ¥ user_name é‡Œé¢çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œç¡®ä¿å…¨éƒ¨éƒ½æ˜¯â€œå­—æ¯æˆ–æ•°å­—)

```
    // Make sure the user name is safe. In particular we need to be
    // cautious of ascii symbols that cmd may interpret specially.
    // Here we only allow alphanumeric characters.
    if !user_name.chars().all(|c| c.is_alphanumeric()) {
        return Err(Error::new(ErrorKind::InvalidInput, "invalid user name"));
    }
```

ç±»ä¼¼äºè¿™ç§æ•ˆæœ:

```
fn main() {
    let s = "test213ğŸ‹&|<>^%'(),;=[]{}";
    s.chars()
        .map(|c| (c, c.is_alphanumeric()))
        .for_each(|(c, is_alnum)| println!("{} is alphanumeric? {}", c, is_alnum));
}

---

t is alphanumeric? true
e is alphanumeric? true
s is alphanumeric? true
t is alphanumeric? true
2 is alphanumeric? true
1 is alphanumeric? true
3 is alphanumeric? true
ğŸ‹ is alphanumeric? false
& is alphanumeric? false
| is alphanumeric? false
< is alphanumeric? false
> is alphanumeric? false
^ is alphanumeric? false
% is alphanumeric? false
' is alphanumeric? false
( is alphanumeric? false
) is alphanumeric? false
, is alphanumeric? false
; is alphanumeric? false
= is alphanumeric? false
[ is alphanumeric? false
] is alphanumeric? false
{ is alphanumeric? false
} is alphanumeric? false
```

--- 

::

