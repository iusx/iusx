---
"title": "Attacking Network Protocols: A Hacker's Guide to Capture, Analysis, and Exploitation"
"director": "James Forshaw"
"time": "2024"
img: "01/1.png"
plan: "1"
---

::book-content{:title="title" :img="img" :by="director" :plan="plan"}

:text-title{:t="Google Project Zero"}
# 作者 1

本书的作者是 [James Forshaw](https://github.com/tyranid)，也是著名的 [Google Project Zero](https://googleprojectzero.blogspot.com/) 成员之一。他负责维护很多开源的分析工具，同时自己也根据多年的经验总结出自己想要的工具。并在一些会议中分享，甚至是 open source。到目前，他已经是一位高级猎食者，从当初的破解游戏机，到揭秘操作系统中的复杂问题，具有十余年应用网络协议分析、利用经验。

| 会议 | 描述 |
| --- | --- |
| [BlackHat](https://www.blackhat.com/) | 国际公认的网络安全活动系列，提供最具技术性和相关性的信息安全研究 |
| [CanSecWest](https://www.secwest.net/) | 加拿大著名的国际信息安全会议，负责举办 Pwn2Own | 
| [Chaos Computer Conference](https://events.ccc.de/) | 由德国 CCC 组织，以其独特的社区文化、技术讨论和社会议题探讨而闻名 |

作者的经历非常 Nice! 有一个良好的家庭，无论做什么都鼓励孩子的家长。走入职场有 Richard Nea 这样不内耗的好 [Leader(line manager)](https://en.wikipedia.org/wiki/Line_management) 同时发现了作者对 Security 领域有浓厚的兴趣并符合其性格。

::text-tip
直线领导(Line manager) 通常指的是直接参与工作并需要对同事工作负责的领导，通常负责指导同事能在特定的职能领域下完成团队或公司的目标。
::

在规划职业路径阶段认识了 [Mike Jordon](https://www.linkedin.com/in/mike-jordon-72193719/) 在初创阶段进入到了 Context Information Security。与公司的创始团队学习，并培养其网络协议分析方面的技能，并开发了 Canape 等工具。这些不内耗的好 Leader，给了其充足的时间进行有前途的安全研究。

::text-tip
2020 年 3 月，世界 500 TOP 之一的 NYSE: ACN 已收购领先的网络防御咨询公司 Context Information Security，该公司之前由母公司 Babcock International Group 所有。Context 成立于 1998 年，总部位于伦敦，是英国和全球金融服务领域最知名、最受尊敬的信息安全服务提供商之一。该公司提供高端网络防御、情报驱动的红队、漏洞研究和事件响应服务。他们曾参与处理业内一些最先进的事件响应案例。

Mike Jordon 曾经是 Context 的首席信息顾问，自 2020 年起为 Airis Security Technologies 的首席技术官。
::

---

我之所以阅读这本书，是因为在我的生活中，几乎还未遇到和协议有关的事情（除了一些常见的场景，如 burp、nmap 这些基础的，或者一些涉及到流量分析的题目）。虽然我见过通过 Wireshark 来调试 API 的，但我认为这些远远不是 Wireshark 的全部功能。

在本书中虽然几乎都是用作者所开发的 Canape ，还包括了很多网络协议工具包，这些工具很多都是家喻户晓的，但成体系和系统性的学习，是我经历所缺少的部分。同时也希望提升自己在网络协议上面的见解，并扩充下眼界。

---


:text-title{:t="协议是一切的基础"}
# 基础 2
"对常见网络的构建和功能了解得越多，就越容易将这些知识应用于捕获、分析和利用新协议。" 这句话出在第一章的概述，小时候。我就对 IETF 非常崇拜，并不是因为他们的宣传，而是朴实无华的运行风格。

还记得第一次看到 IETF 的出版物，被 RFC 的简洁所震撼。这种朴实无华的风格，不仅简洁还充满了复古风味内容也相当丰富，记录了一个协议和提案标准的各类信息。以及协议提案的流程，该提案所经历过的所有环节依次公开。

一个标准的协议具有很多或很少的功能，但他们几乎或多或少符合下面六项特点中的一项：

| 功能 | 描述 |
| --- | --- |
| 维护会话状态 | 创建新的连接或终止连接 |
| 通过寻址识别节点 | 数据需要传输到对应的节点，因此协议通过寻址来识别特定的节点或组 |
| 控制流量 | 一次性通过网络传输的量是有限的。协议通过实施管理数据流，以提高吞吐减少延迟 |
| 保证传输数据的顺序 | 将发送和接收到分散且混乱的数据重新排序，以保证数据的正确顺序 |
| 检测和纠正错误 | 网络不是 100% 可靠的;数据可能会损坏。检测损坏并理想情况下纠正它非常重要 |
| 格式化和编码数据 | 数据并不适合在网络中传输，例如将英语文本编码为二进制值；协议可以指定对数据进行编码甚至加密 |

我们都了解很多传输协议，这些协议是基础的。但很多时候，这些协议都是背后的一条条数据流，我们浏览网页，使用 APP 不需要思考这些是如何进行的，死记硬背不仅内耗自己，还花了很多时间，但在工作中几乎只有面试时才会用到。而基础章节中，作者总结出了自己的一套模型：

```text
┌──────────────────────────────┐                                             
│        Protocol model        │                                             
│                              │                                             
│  ┌────────────────────────┐  │                                             
│  │     Content layer      │  │   I would like to get the file image.png    
│  │     (File request)     │  │                                             
│  └───────────▲────────────┘  │                                             
│              │               │                                             
│  ┌───────────▼────────────┐  │                                             
│  │     Encoding layer     │  │   GET /image.png HTTP/1.1                   
│  │         (HTTP)         │  │                                             
│  └───────────▲────────────┘  │                                             
│              │               │                                             
│  ┌───────────▼────────────┐  │                                             
│  │    Transport layer     │  │   4500 0043 50d1 4000 8000 c0a8 0a6d        
│  │        (TCP/IP)        │  │   d83a d544 40e0 0050 5dff a4e6 6ac2        
│  └────────────────────────┘  │   ……                                        
│                              │                                             
└──────────────────────────────┘
```

| 协议模型 | 描述  |
| --- | --- |
| 内容层 (文件请求) | 我想要一个 image.png 图片 |
| 编码层 (HTTP) | GET /image.png HTTP/1.1 |
| 传输层 (TCP/IP) | 4500 0043 50d1 4000 8000 c0a8 0a6d <br> d83a d544 40e0 0050 5dff a4e6 6ac2 …… | 

作者的这套网络模型，几乎概述了传输所涵盖的三个特点，即内容、寻址、传输等三个功能的概念化，因此适用于总结或对一个陌生的协议时的理解步骤。毕竟协议是可以自定义的，例如通过 Matrix 就可以自定义一个通信协议。

::text-tip
"以这种方式拆分模型可以降低特定于应用程序的协议的复杂性，因为它允许我们过滤掉不相关的网络协议详细信息。例如，因为我们并不真正关心 TCP/IP 是如何发送到远程节点的（我们理所当然地认为它会以某种方式到达那里），所以我们只是将 TCP/IP 数据视为正常工作的二进制传输。"
::

这一章节非常有意思，可以看一下原文 第一章：My Model for Network Protocol Analysis，给出了很多贴近该模型的案例。作者是一个不内耗的人，不会解说一堆 RFC 文件和 Wikipedia 中的内容，仅列举其作用和描述，让读者感兴趣的地方可以深入了解，并得出自己的见解。



::
