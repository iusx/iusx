<!DOCTYPE html><html><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Attacking Network Protocols: A Hacker&#x27;s Guide to Capture, Analysis, and Exploitation - ritsu</title>
<meta property="og:title" content="Attacking Network Protocols: A Hacker's Guide to Capture, Analysis, and Exploitation">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/book/attacking-network-protocols/_payload.json?cc738484-d7be-44c9-898c-02eb7dab1201">
<style>@font-face{font-family:swiper-icons;font-style:normal;font-weight:400;src:url("data:application/font-woff;charset=utf-8;base64, d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA")}:root{--swiper-theme-color:#007aff}:host{display:block;margin-left:auto;margin-right:auto;position:relative;z-index:1}.swiper{display:block;list-style:none;margin-left:auto;margin-right:auto;overflow:hidden;overflow:clip;padding:0;position:relative;z-index:1}.swiper-vertical>.swiper-wrapper{flex-direction:column}.swiper-wrapper{box-sizing:content-box;display:flex;height:100%;position:relative;transition-property:transform;transition-timing-function:var(--swiper-wrapper-transition-timing-function,initial);width:100%;z-index:1}.swiper-android .swiper-slide,.swiper-ios .swiper-slide,.swiper-wrapper{transform:translateZ(0)}.swiper-horizontal{touch-action:pan-y}.swiper-vertical{touch-action:pan-x}.swiper-slide{display:block;flex-shrink:0;height:100%;position:relative;transition-property:transform;width:100%}.swiper-slide-invisible-blank{visibility:hidden}.swiper-autoheight,.swiper-autoheight .swiper-slide{height:auto}.swiper-autoheight .swiper-wrapper{align-items:flex-start;transition-property:transform,height}.swiper-backface-hidden .swiper-slide{backface-visibility:hidden;transform:translateZ(0)}.swiper-3d.swiper-css-mode .swiper-wrapper{perspective:1200px}.swiper-3d .swiper-wrapper{transform-style:preserve-3d}.swiper-3d{perspective:1200px}.swiper-3d .swiper-cube-shadow,.swiper-3d .swiper-slide{transform-style:preserve-3d}.swiper-css-mode>.swiper-wrapper{overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.swiper-css-mode>.swiper-wrapper::-webkit-scrollbar{display:none}.swiper-css-mode>.swiper-wrapper>.swiper-slide{scroll-snap-align:start start}.swiper-css-mode.swiper-horizontal>.swiper-wrapper{scroll-snap-type:x mandatory}.swiper-css-mode.swiper-vertical>.swiper-wrapper{scroll-snap-type:y mandatory}.swiper-css-mode.swiper-free-mode>.swiper-wrapper{scroll-snap-type:none}.swiper-css-mode.swiper-free-mode>.swiper-wrapper>.swiper-slide{scroll-snap-align:none}.swiper-css-mode.swiper-centered>.swiper-wrapper:before{content:"";flex-shrink:0;order:9999}.swiper-css-mode.swiper-centered>.swiper-wrapper>.swiper-slide{scroll-snap-align:center center;scroll-snap-stop:always}.swiper-css-mode.swiper-centered.swiper-horizontal>.swiper-wrapper>.swiper-slide:first-child{margin-inline-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-horizontal>.swiper-wrapper:before{height:100%;min-height:1px;width:var(--swiper-centered-offset-after)}.swiper-css-mode.swiper-centered.swiper-vertical>.swiper-wrapper>.swiper-slide:first-child{margin-block-start:var(--swiper-centered-offset-before)}.swiper-css-mode.swiper-centered.swiper-vertical>.swiper-wrapper:before{height:var(--swiper-centered-offset-after);min-width:1px;width:100%}.swiper-3d .swiper-slide-shadow,.swiper-3d .swiper-slide-shadow-bottom,.swiper-3d .swiper-slide-shadow-left,.swiper-3d .swiper-slide-shadow-right,.swiper-3d .swiper-slide-shadow-top{height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:10}.swiper-3d .swiper-slide-shadow{background:rgba(0,0,0,.15)}.swiper-3d .swiper-slide-shadow-left{background-image:linear-gradient(270deg,rgba(0,0,0,.5),transparent)}.swiper-3d .swiper-slide-shadow-right{background-image:linear-gradient(90deg,rgba(0,0,0,.5),transparent)}.swiper-3d .swiper-slide-shadow-top{background-image:linear-gradient(0deg,rgba(0,0,0,.5),transparent)}.swiper-3d .swiper-slide-shadow-bottom{background-image:linear-gradient(180deg,rgba(0,0,0,.5),transparent)}.swiper-lazy-preloader{border:4px solid var(--swiper-preloader-color,var(--swiper-theme-color));border-radius:50%;border-top:4px solid transparent;box-sizing:border-box;height:42px;left:50%;margin-left:-21px;margin-top:-21px;position:absolute;top:50%;transform-origin:50%;width:42px;z-index:10}.swiper-watch-progress .swiper-slide-visible .swiper-lazy-preloader,.swiper:not(.swiper-watch-progress) .swiper-lazy-preloader{animation:swiper-preloader-spin 1s linear infinite}.swiper-lazy-preloader-white{--swiper-preloader-color:#fff}.swiper-lazy-preloader-black{--swiper-preloader-color:#000}@keyframes swiper-preloader-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}</style>
<style>.swiper .swiper-notification{left:0;opacity:0;pointer-events:none;position:absolute;top:0;z-index:-1000}</style>
<style>.swiper-cards{overflow:visible}.swiper-cards .swiper-slide{backface-visibility:hidden;overflow:hidden;transform-origin:center bottom}</style>
<style>.swiper-creative .swiper-slide{backface-visibility:hidden;overflow:hidden;transition-property:transform,opacity,height}</style>
<style>.swiper-cube{overflow:visible}.swiper-cube .swiper-slide{backface-visibility:hidden;height:100%;pointer-events:none;transform-origin:0 0;visibility:hidden;width:100%;z-index:1}.swiper-cube .swiper-slide .swiper-slide{pointer-events:none}.swiper-cube.swiper-rtl .swiper-slide{transform-origin:100% 0}.swiper-cube .swiper-slide-active,.swiper-cube .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-cube .swiper-slide-active,.swiper-cube .swiper-slide-next,.swiper-cube .swiper-slide-prev{pointer-events:auto;visibility:visible}.swiper-cube .swiper-cube-shadow{bottom:0;height:100%;left:0;opacity:.6;position:absolute;width:100%;z-index:0}.swiper-cube .swiper-cube-shadow:before{background:#000;bottom:0;content:"";filter:blur(50px);left:0;position:absolute;right:0;top:0}.swiper-cube .swiper-slide-next+.swiper-slide{pointer-events:auto;visibility:visible}.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-bottom,.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-left,.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-right,.swiper-cube .swiper-slide-shadow-cube.swiper-slide-shadow-top{backface-visibility:hidden;z-index:0}</style>
<style>.swiper-fade.swiper-free-mode .swiper-slide{transition-timing-function:ease-out}.swiper-fade .swiper-slide{pointer-events:none;transition-property:opacity}.swiper-fade .swiper-slide .swiper-slide{pointer-events:none}.swiper-fade .swiper-slide-active,.swiper-fade .swiper-slide-active .swiper-slide-active{pointer-events:auto}</style>
<style>.swiper-flip{overflow:visible}.swiper-flip .swiper-slide{backface-visibility:hidden;pointer-events:none;z-index:1}.swiper-flip .swiper-slide .swiper-slide{pointer-events:none}.swiper-flip .swiper-slide-active,.swiper-flip .swiper-slide-active .swiper-slide-active{pointer-events:auto}.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-bottom,.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-left,.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-right,.swiper-flip .swiper-slide-shadow-flip.swiper-slide-shadow-top{backface-visibility:hidden;z-index:0}</style>
<style>.swiper-free-mode>.swiper-wrapper{margin:0 auto;transition-timing-function:ease-out}</style>
<style>.swiper-grid>.swiper-wrapper{flex-wrap:wrap}.swiper-grid-column>.swiper-wrapper{flex-direction:column;flex-wrap:wrap}</style>
<style>:root{--swiper-navigation-size:44px}.swiper-button-next,.swiper-button-prev{align-items:center;color:var(--swiper-navigation-color,var(--swiper-theme-color));cursor:pointer;display:flex;height:var(--swiper-navigation-size);justify-content:center;margin-top:calc(0px - var(--swiper-navigation-size)/2);position:absolute;top:var(--swiper-navigation-top-offset,50%);width:calc(var(--swiper-navigation-size)/44*27);z-index:10}.swiper-button-next.swiper-button-disabled,.swiper-button-prev.swiper-button-disabled{cursor:auto;opacity:.35;pointer-events:none}.swiper-button-next.swiper-button-hidden,.swiper-button-prev.swiper-button-hidden{cursor:auto;opacity:0;pointer-events:none}.swiper-navigation-disabled .swiper-button-next,.swiper-navigation-disabled .swiper-button-prev{display:none!important}.swiper-button-next svg,.swiper-button-prev svg{height:100%;-o-object-fit:contain;object-fit:contain;transform-origin:center;width:100%}.swiper-rtl .swiper-button-next svg,.swiper-rtl .swiper-button-prev svg{transform:rotate(180deg)}.swiper-button-prev,.swiper-rtl .swiper-button-next{left:var(--swiper-navigation-sides-offset,10px);right:auto}.swiper-button-lock{display:none}.swiper-button-next:after,.swiper-button-prev:after{font-family:swiper-icons;font-size:var(--swiper-navigation-size);font-variant:normal;letter-spacing:0;line-height:1;text-transform:none!important}.swiper-button-prev:after,.swiper-rtl .swiper-button-next:after{content:"prev"}.swiper-button-next,.swiper-rtl .swiper-button-prev{left:auto;right:var(--swiper-navigation-sides-offset,10px)}.swiper-button-next:after,.swiper-rtl .swiper-button-prev:after{content:"next"}</style>
<style>.swiper-pagination{position:absolute;text-align:center;transform:translateZ(0);transition:opacity .3s;z-index:10}.swiper-pagination.swiper-pagination-hidden{opacity:0}.swiper-pagination-disabled>.swiper-pagination,.swiper-pagination.swiper-pagination-disabled{display:none!important}.swiper-horizontal>.swiper-pagination-bullets,.swiper-pagination-bullets.swiper-pagination-horizontal,.swiper-pagination-custom,.swiper-pagination-fraction{bottom:var(--swiper-pagination-bottom,8px);left:0;top:var(--swiper-pagination-top,auto);width:100%}.swiper-pagination-bullets-dynamic{font-size:0;overflow:hidden}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{position:relative;transform:scale(.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active,.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-main{transform:scale(1)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-prev-prev{transform:scale(.33)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next{transform:scale(.66)}.swiper-pagination-bullets-dynamic .swiper-pagination-bullet-active-next-next{transform:scale(.33)}.swiper-pagination-bullet{background:var(--swiper-pagination-bullet-inactive-color,#000);border-radius:var(--swiper-pagination-bullet-border-radius,50%);display:inline-block;height:var(--swiper-pagination-bullet-height,var(--swiper-pagination-bullet-size,8px));opacity:var(--swiper-pagination-bullet-inactive-opacity,.2);width:var(--swiper-pagination-bullet-width,var(--swiper-pagination-bullet-size,8px))}button.swiper-pagination-bullet{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;box-shadow:none;margin:0;padding:0}.swiper-pagination-clickable .swiper-pagination-bullet{cursor:pointer}.swiper-pagination-bullet:only-child{display:none!important}.swiper-pagination-bullet-active{background:var(--swiper-pagination-color,var(--swiper-theme-color));opacity:var(--swiper-pagination-bullet-opacity,1)}.swiper-pagination-vertical.swiper-pagination-bullets,.swiper-vertical>.swiper-pagination-bullets{left:var(--swiper-pagination-left,auto);right:var(--swiper-pagination-right,8px);top:50%;transform:translate3d(0,-50%,0)}.swiper-pagination-vertical.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets .swiper-pagination-bullet{display:block;margin:var(--swiper-pagination-bullet-vertical-gap,6px) 0}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{top:50%;transform:translateY(-50%);width:8px}.swiper-pagination-vertical.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-vertical>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{display:inline-block;transition:transform .2s,top .2s}.swiper-horizontal>.swiper-pagination-bullets .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets .swiper-pagination-bullet{margin:0 var(--swiper-pagination-bullet-horizontal-gap,4px)}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic{left:50%;transform:translateX(-50%);white-space:nowrap}.swiper-horizontal>.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet,.swiper-pagination-horizontal.swiper-pagination-bullets.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:transform .2s,left .2s}.swiper-horizontal.swiper-rtl>.swiper-pagination-bullets-dynamic .swiper-pagination-bullet{transition:transform .2s,right .2s}.swiper-pagination-fraction{color:var(--swiper-pagination-fraction-color,inherit)}.swiper-pagination-progressbar{background:var(--swiper-pagination-progressbar-bg-color,rgba(0,0,0,.25));position:absolute}.swiper-pagination-progressbar .swiper-pagination-progressbar-fill{background:var(--swiper-pagination-color,var(--swiper-theme-color));height:100%;left:0;position:absolute;top:0;transform:scale(0);transform-origin:left top;width:100%}.swiper-rtl .swiper-pagination-progressbar .swiper-pagination-progressbar-fill{transform-origin:right top}.swiper-horizontal>.swiper-pagination-progressbar,.swiper-pagination-progressbar.swiper-pagination-horizontal,.swiper-pagination-progressbar.swiper-pagination-vertical.swiper-pagination-progressbar-opposite,.swiper-vertical>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite{height:var(--swiper-pagination-progressbar-size,4px);left:0;top:0;width:100%}.swiper-horizontal>.swiper-pagination-progressbar.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-horizontal.swiper-pagination-progressbar-opposite,.swiper-pagination-progressbar.swiper-pagination-vertical,.swiper-vertical>.swiper-pagination-progressbar{height:100%;left:0;top:0;width:var(--swiper-pagination-progressbar-size,4px)}.swiper-pagination-lock{display:none}</style>
<style>.swiper-scrollbar{background:var(--swiper-scrollbar-bg-color,rgba(0,0,0,.1));border-radius:var(--swiper-scrollbar-border-radius,10px);position:relative;touch-action:none}.swiper-scrollbar-disabled>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-disabled{display:none!important}.swiper-horizontal>.swiper-scrollbar,.swiper-scrollbar.swiper-scrollbar-horizontal{bottom:var(--swiper-scrollbar-bottom,4px);height:var(--swiper-scrollbar-size,4px);left:var(--swiper-scrollbar-sides-offset,1%);position:absolute;top:var(--swiper-scrollbar-top,auto);width:calc(100% - var(--swiper-scrollbar-sides-offset, 1%)*2);z-index:50}.swiper-scrollbar.swiper-scrollbar-vertical,.swiper-vertical>.swiper-scrollbar{height:calc(100% - var(--swiper-scrollbar-sides-offset, 1%)*2);left:var(--swiper-scrollbar-left,auto);position:absolute;right:var(--swiper-scrollbar-right,4px);top:var(--swiper-scrollbar-sides-offset,1%);width:var(--swiper-scrollbar-size,4px);z-index:50}.swiper-scrollbar-drag{background:var(--swiper-scrollbar-drag-bg-color,rgba(0,0,0,.5));border-radius:var(--swiper-scrollbar-border-radius,10px);height:100%;left:0;position:relative;top:0;width:100%}.swiper-scrollbar-cursor-drag{cursor:move}.swiper-scrollbar-lock{display:none}</style>
<style>.swiper-virtual .swiper-slide{-webkit-backface-visibility:hidden;transform:translateZ(0)}.swiper-virtual.swiper-css-mode .swiper-wrapper:after{content:"";left:0;pointer-events:none;position:absolute;top:0}.swiper-virtual.swiper-css-mode.swiper-horizontal .swiper-wrapper:after{height:1px;width:var(--swiper-virtual-size)}.swiper-virtual.swiper-css-mode.swiper-vertical .swiper-wrapper:after{height:var(--swiper-virtual-size);width:1px}</style>
<style>.swiper-zoom-container{align-items:center;display:flex;height:100%;justify-content:center;text-align:center;width:100%}.swiper-zoom-container>canvas,.swiper-zoom-container>img,.swiper-zoom-container>svg{max-height:100%;max-width:100%;-o-object-fit:contain;object-fit:contain}.swiper-slide-zoomed{cursor:move;touch-action:none}</style>
<style>.icon[data-v-2b6644a8]{display:inline-block;vertical-align:middle}</style>
<style>main[data-v-fb5a971c]{background-image:url(/img/page/drag.png);background-repeat:no-repeat;background:#000;border-left:3px solid #00ff48;box-shadow:-1px 0 0 0 #00ff48;cursor:pointer;position:fixed;right:0;right:-40px;top:30%!important;width:-moz-fit-content;width:fit-content;z-index:11}a[data-v-fb5a971c],main[data-v-fb5a971c]{color:#fff}a[data-v-fb5a971c]{display:block;filter:grayscale(100%);font-size:small;margin:10px;opacity:.5;text-decoration:none;transition:filter .3s ease,opacity .3s ease}.active[data-v-fb5a971c],a[data-v-fb5a971c]:hover{filter:brightness(1);opacity:1}</style>
<style>@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap");.main-con li,.main-con li a{color:#888}.main-con table{margin-bottom:15px;margin-top:15px;width:100%!important}.main-con table thead{background:hsla(0,0%,96%,.58)}.main-con table tr th{color:#888;font-size:16px;font-weight:inherit;padding:7px;text-align:inherit}.main-con table td{color:#888;font-size:15px;padding:7px}.main-con tbody a{color:#989898;transition:color .3s ease}.main-con p a,.main-con tbody a{text-decoration:underline}.dark-mode table thead{background:hsla(0,0%,96%,.071);color:#6d6d6d}.dark-mode table td{color:#8f8f8f}.dark-mode body{background:#000}.dark-mode body li a{color:#888}@font-face{font-family:tsing;src:url(/tsing.ttf)}body{font-family:Roboto,sans-serif;height:100%;margin:0;padding:0;width:100%}.dark-mode .content img,.dark-mode .page-content{filter:brightness(70%)}.text p{font-size:15px;line-height:1.6}.tips{z-index:10}.page-sec .swiper-slide{height:300px!important;width:300px!important}.ref a{color:#888;text-transform:none}.ref a,.text h3 a{text-decoration:none}.text h3 a{color:#000}.dark-mode .text h3 a{color:#fff}.dark-mode .ref a{color:#a2a2a2!important}html::-webkit-scrollbar{width:1px}html::-webkit-scrollbar-track{background-color:hsla(0,0%,100%,0)}html::-webkit-scrollbar-thumb{background:#000;border-radius:25px}.markdown-content h1,h2,h3,h4,h5,h6{color:rgba(0,0,0,.189);font-size:0;text-transform:uppercase}.markdown-content hr{border-color:hsla(0,0%,100%,.42);margin:100px}.dark-mode .markdown-content pre,.markdown-content code{border:1px solid #363636!important}.dark-mode .markdown-content img{opacity:.7}.dark-mode .markdown-content hr{border-color:hsla(0,0%,43%,.502)}.markdown-content{padding-bottom:100px;padding-top:40px}.markdown-content li,.markdown-content ul{font-size:15px;margin:0!important}@media (max-width:1024px){.markdown-content{padding-top:100px}}.markdown-content table tr:hover{background:hsla(0,0%,96%,.58)}.dark-mode table tr:hover{background:hsla(0,0%,96%,.071)}@media (prefers-color-scheme:dark){.markdown-content strong,b{color:#fff!important}.markdown-content pre{border:1px solid #444!important}.markdown-content .MathJax{color:#fff}}.markdown-content{display:block;max-width:100%}.markdown-content b,.markdown-content strong{color:#000}.markdown-content *,.markdown-content :after,.markdown-content :before{box-sizing:border-box}.markdown-content code,.markdown-content pre{border:1px solid #cdcdcd!important;display:block;line-height:1.5;margin:.5em 0;max-width:100%;min-width:0;overflow:auto;padding:1em;width:100%;word-wrap:break-word}.markdown-content pre::-webkit-scrollbar{height:10px}.markdown-content pre::-webkit-scrollbar-track{background:transition}.markdown-content pre::-webkit-scrollbar-thumb{background-color:#666}.markdown-content pre::-webkit-scrollbar-thumb:hover{background-color:#999}.markdown-content code{color:#1e6eb2;display:contents;padding-left:2px;padding-right:2px}.markdown-content pre code{color:#000}.dark-mode .markdown-content pre code{color:#a0a0a0}.markdown-content ol{color:#888;font-size:15px;line-height:2}.markdown-content{display:inline-grid;min-width:100%;width:100%}.markdown-content p{display:block;word-wrap:break-word;color:#888;font-size:15px;margin:0;margin-block:1vw;padding:0}.markdown-content p:last-child{margin-bottom:0}@media (max-width:1024px){.markdown-content p{margin-block:4vw}}.markdown-content b,.markdown-content div,.markdown-content li,.markdown-content main,.markdown-content mjx-container,.markdown-content ol,.markdown-content p,.markdown-content pre,.markdown-content span,.markdown-content table{border-left:1px solid transparent}.markdown-content b:hover,.markdown-content div:hover,.markdown-content li:hover,.markdown-content main:hover,.markdown-content mjx-container:hover,.markdown-content ol:hover,.markdown-content p:hover,.markdown-content pre:hover,.markdown-content span:hover,.markdown-content table:hover{border-left:1px solid #00dd82!important}.markdown-content .MathJax{display:inline-block;max-width:100%;overflow-x:auto;word-wrap:break-word;box-sizing:border-box;white-space:normal}@media (max-width:768px){.markdown-content table,.markdown-content tbody,.markdown-content td,.markdown-content th,.markdown-content thead,.markdown-content tr{display:block;width:100%}.markdown-content tr{border:1px solid rgba(61,61,61,.161);margin-bottom:15px}}.dark-mode .markdown-content h1{color:hsla(0,0%,100%,.588)}.dark-mode tr{border:1px solid #373737}.cve-info{border-top:1px solid #e4e4e4;padding:12px}.cve-info p{margin:0;margin-top:0!important;padding-top:0!important}.dark-mode .cve-info{border-top:1px solid hsla(0,0%,100%,.18)}.markdown-content iframe{margin-bottom:30px;margin-top:30px}@font-face{font-family:Tsing;src:url(/Tsing.woff2) format("woff2"),url(/Tsing.woff) format("woff"),url(/Tsing.ttf) format("truetype")}@keyframes fadeIn{0%{opacity:0;visibility:hidden}to{opacity:1;visibility:visible}}#app{animation:fadeIn 2s 1s forwards;opacity:0;visibility:hidden}</style>
<style>p a{color:#989898;text-decoration:none;transition:color .3s ease}p a:hover{color:#00dd82}</style>
<style>.book-table[data-v-3aa98d60]{background:#fff!important;width:85vw!important}.dark-mode .book-table[data-v-3aa98d60]{background:#000!important}@keyframes loading-3aa98d60{0%,to{opacity:1}50%{opacity:.5}}.no-img[data-v-3aa98d60]{animation:loading-3aa98d60 1.5s infinite;aspect-ratio:54/71;background-color:#f2f2f2}.dark-mode .no-img[data-v-3aa98d60]{background-color:#1d1d1d}@media (max-width:1024px){.pc[data-v-3aa98d60]{display:none}}.pop-close[data-v-3aa98d60]{color:#000;font-family:tsing;font-weight:700;position:absolute;right:10px}.dark-mode .pop-close[data-v-3aa98d60],.more[data-v-3aa98d60]{color:#fff}.more[data-v-3aa98d60]{cursor:pointer;font-family:tsing}.an[data-v-3aa98d60]{display:none}@media (max-width:1024px){.an[data-v-3aa98d60]{background:#00dd82;display:block;font-size:1.3vh;font-weight:700;padding:8px;position:fixed;z-index:9999}}.book-info[data-v-3aa98d60]{height:100vh;overflow:auto;padding-right:1vw;position:fixed;width:21vw;z-index:99999999}.book-info img[data-v-3aa98d60]{width:100%}@media (max-width:1024px){.book-info img[data-v-3aa98d60]{width:50%}}.book-info .book-info-author[data-v-3aa98d60]{align-items:center;color:#7f7f7f;display:flex;font-size:15px;justify-content:space-between}.book-info .book-info-author span[data-v-3aa98d60]{text-transform:uppercase}.book-info .title p[data-v-3aa98d60]{font-size:23px;margin:0 0 5px}.book-info .title span[data-v-3aa98d60]{color:rgba(0,0,0,.593);font-size:1.9vh}.book-info .dir-layout .title[data-v-3aa98d60]{border:1px solid #000;color:#000;display:block;font-size:11px;margin-bottom:12px;margin-top:15px;padding:8px;text-transform:uppercase;width:-moz-fit-content;width:fit-content}.dark-mode .book-info .title span[data-v-3aa98d60]{color:hsla(0,0%,100%,.59)}.dark-mode .book-info .title p[data-v-3aa98d60]{color:#b3b3b3}.dark-mode .book-info img[data-v-3aa98d60]{opacity:.7}.dark-mode .book-info .dir-layout .title[data-v-3aa98d60]{border:1px solid #fff;color:#fff}.dark-mode .dir-layout[data-v-3aa98d60]{opacity:.8}.book-info[data-v-3aa98d60]::-webkit-scrollbar{cursor:pointer!important;height:10px;width:10px}.book-info[data-v-3aa98d60]::-webkit-scrollbar-track{background-color:hsla(0,0%,100%,0);cursor:pointer!important}.book-info[data-v-3aa98d60]::-webkit-scrollbar-thumb{border:1px solid rgba(0,0,0,.197);cursor:pointer!important;-webkit-transition:background .5s ease;transition:background .5s ease}.book-info[data-v-3aa98d60]::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.068);cursor:pointer!important}.dark-mode .book-info[data-v-3aa98d60]::-webkit-scrollbar-thumb{border:1px solid hsla(0,0%,100%,.238)}.dark-mode .book-info[data-v-3aa98d60]::-webkit-scrollbar-thumb:hover{background-color:hsla(0,0%,100%,.068)}@-moz-document url-prefix(){.book-info[data-v-3aa98d60]{scrollbar-color:rgba(0,0,0,.197) transparent;scrollbar-width:thin}.dark-mode .book-info[data-v-3aa98d60]{scrollbar-color:hsla(0,0%,100%,.238) transparent}}.main-con[data-v-3aa98d60]{margin-left:25vw}@media (max-width:1024px){.main-con[data-v-3aa98d60]{margin-left:0}}main[data-v-3aa98d60]{margin:0 auto;overflow-x:hidden;overflow:visible;width:85%}.layout[data-v-3aa98d60]{display:flex}table[data-v-3aa98d60]{width:100%}</style>
<style>ul[data-v-e205a500]{list-style:none;padding:0}ul li[data-v-e205a500]{align-items:center;display:flex;justify-content:space-between;margin:10.8px 2px;max-width:100%}li[data-v-e205a500]{background:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='930' height='1' fill='none'%3E%3Cpath stroke='%23D7D7D7' d='M.5.5H930'/%3E%3C/svg%3E") no-repeat 50%}a[data-v-e205a500]{align-items:center;background:#fff;color:#000;display:flex;font-size:14px;padding-right:.6vw;text-decoration:none;width:-moz-max-content;width:max-content}a[data-v-e205a500]:before{border:1px solid #000;content:"";display:block;height:.7vh;margin-left:1px;margin-right:.9vh;transform:rotate(45deg);width:.7vh}.dark-mode a[data-v-e205a500]{background:#000;color:#898989}.dark-mode a[data-v-e205a500]:before{border:1px solid #898989}span[data-v-e205a500]:before{background-color:#fff;border:1px solid #000;transform:rotate(45deg)}.no[data-v-e205a500]:before,span[data-v-e205a500]:before{content:"";display:block;height:.7vh;width:.7vh}.no[data-v-e205a500]:before{background-color:#d7d7d7;border-radius:100%;margin:0!important;padding:0!important}</style>
<style>.text-title-color p[data-v-f0803dcc]{color:#3f3f3f!important;position:relative;z-index:-1}.title[data-v-f0803dcc]{font-size:20px!important}.h2[data-v-f0803dcc]{font-size:17px;margin-top:130px;opacity:.8}.dark-mode .text-title-color p[data-v-f0803dcc]{color:#fff!important}</style>
<style>.text-tip{background:hsla(0,0%,96%,.58);border-left:1px solid #888;padding:7px}.text-tip li,.text-tip p{color:#888;font-size:13px;margin-bottom:0!important;width:-moz-fit-content;width:fit-content}.text-tip p:first-child{color:#888;margin-top:0}.text-tip ol li{color:#888;font-size:13px}.text-tip ul:last-child{margin-bottom:0}.dark-mode .text-tip{background:hsla(0,0%,96%,.071)}.big{align-content:center;align-items:center;display:flex;flex-direction:column;font-style:oblique;padding:13px}.big p{font-size:15px}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/entry.DAK6rBbm.css">
<link rel="stylesheet" href="/_nuxt/swiper-vue.Bs3d9ZnH.css">
<link rel="stylesheet" href="/_nuxt/ProseCode.CchFRBtv.css">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DX02sL2T.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Zy9w3lSu.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BFy-3U74.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Oa1aFpRO.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_BYjnBeW.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BVBiqKJw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BsYmvPZw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DQwKRJS9.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BPOFvqIV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dingh0LT.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DVTW-uL3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CF5KRtlt.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/aVt5eIPr.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/oEHATd5w.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DqZNQK5n.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/k6-tyP3T.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CT96lRlw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DYrRi6t4.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ce6aAat7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dm3poHP3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWZ2a1Zu.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CsWN9LYW.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CROatLPK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/3FfGoJq7.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dvpveg3X.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D7w8NDmS.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BnisWOac.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C0k6LtqN.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D3fvKj3v.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/3HPmE7LM.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/H7Q_3svx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dn-v7I_O.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DIe4INh0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DPzLAJxC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B3WQry3n.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cl1Rqe4u.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D-R32Ky6.js">
<script type="module" src="/_nuxt/DX02sL2T.js" crossorigin></script><script>"use strict";(()=>{const a=window,e=document.documentElement,c=window.localStorage,d=["dark","light"],n=c&&c.getItem&&c.getItem("nuxt-color-mode")||"system";let l=n==="system"?f():n;const i=e.getAttribute("data-color-mode-forced");i&&(l=i),r(l),a["__NUXT_COLOR_MODE__"]={preference:n,value:l,getColorScheme:f,addColorScheme:r,removeColorScheme:u};function r(o){const t=""+o+"-mode",s="";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function u(o){const t=""+o+"-mode",s="";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function m(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&m("").media!=="not all"){for(const o of d)if(m(":"+o).matches)return o}return"light"}})();
</script></head><body><div id="__nuxt"><div id="app"><main style="left:undefinedpx;top:300px;" data-v-fb5a971c><a href="/" class="" data-v-fb5a971c><svg width="30px" height="30px" viewbox="0 0 81 83" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-fb5a971c data-v-2b6644a8><rect x="40.2487" y="5.53553" width="51.9203" height="51.9203" transform="rotate(45 40.2487 5.53553)" stroke="white" stroke-opacity="0.24" stroke-width="5"></rect><path d="M40.6957 66.8376C42.8762 68.6088 44.9958 70.4441 47.0849 72.3219C47.7004 73.5975 48.3128 74.8755 48.9221 76.1558C47.0922 75.5742 45.2231 75.1235 43.3292 74.8071C40.7414 73.0467 38.1211 71.3415 35.4684 69.6915C35.314 68.424 35.1342 67.1606 34.9372 65.8992C36.8755 66.083 38.7993 66.3965 40.6957 66.8376Z" stroke="url(#paint0_linear_549_352)" stroke-width="3"></path><path d="M28.7653 66.2912C30.4316 67.1389 32.0871 68.0089 33.7317 68.9013C33.6413 67.6541 33.5286 66.409 33.3894 65.1659C30.8504 62.4576 28.3114 59.7456 25.7723 57.0299C24.2692 56.2072 22.7458 55.4201 21.2143 54.6523C21.5034 56.1527 21.7881 57.6538 22.0684 59.1555C24.2987 61.5361 26.531 63.9147 28.7653 66.2912Z" stroke="url(#paint1_linear_549_352)" stroke-width="3"></path><path d="M20.9614 53.6702C22.6141 54.4468 24.2523 55.2495 25.8759 56.0782C25.9978 53.7342 26.0994 51.3892 26.206 49.0441C24.7842 46.5732 23.3735 44.0971 21.9486 41.6302C20.5125 41.165 19.0693 40.7283 17.619 40.3201C17.5087 41.8787 17.3963 43.4393 17.2819 45.002C18.504 47.8931 19.7305 50.7825 20.9614 53.6702Z" stroke="url(#paint2_linear_549_352)" stroke-width="3"></path><path d="M53.4681 76.9744C52.4291 75.7628 51.4104 74.537 50.3319 73.3588C49.8698 73.1679 49.5407 73.1253 48.4103 73.2979C49.0796 74.4496 49.7601 75.5932 50.4416 76.7357C52.1498 77.498 53.7879 78.4088 55.3368 79.4576C55.6486 79.2839 55.676 79.2666 55.6831 79.2595C54.9245 78.5171 54.181 77.7575 53.4681 76.9744Z" stroke="url(#paint3_linear_549_352)" stroke-width="3"></path><path d="M47.5846 72.0172C48.7353 72.0446 49.108 72.1665 49.6849 72.5098C48.5684 70.8019 47.5593 69.0263 46.6634 67.1931C45.4193 64.9983 44.2077 62.7843 42.9768 60.5815C41.9612 60.1315 40.8216 59.9904 39.7187 59.9873C40.1341 62.0795 40.5881 64.1625 41.039 66.2465C43.2906 68.1 45.4579 70.0327 47.5846 72.0172Z" stroke="url(#paint4_linear_549_352)" stroke-width="3"></path><path d="M33.9927 64.4611C35.9253 64.6587 37.8428 64.983 39.7329 65.432C39.3267 63.2617 38.9204 61.0913 38.5507 58.9148C36.6536 56.1148 34.7706 53.3067 32.8633 50.5178C31.0454 50.2263 29.2071 50.1339 27.3709 50.073C27.2927 52.3672 27.2196 54.6625 27.1282 56.9567C29.418 59.4558 31.7062 61.9573 33.9927 64.4611Z" stroke="url(#paint5_linear_549_352)" stroke-width="3"></path><path d="M22.496 41.0483C23.9625 43.566 25.4118 46.0938 26.8692 48.6176C28.8029 48.6168 30.7352 48.7185 32.6582 48.9223C32.8613 46.0156 33.1517 43.1262 33.5519 40.2388C32.2123 37.5342 30.7915 34.8855 29.2335 32.2988C27.4007 32.7206 25.5726 33.1681 23.7492 33.6414C23.3085 36.1066 22.8907 38.5756 22.496 41.0483Z" stroke="url(#paint6_linear_549_352)" stroke-width="3"></path><path d="M43.125 60.0097C44.2646 62.3517 45.4163 64.6815 46.633 66.9869C46.9122 67.1748 46.9295 67.3363 47.1783 67.5414C46.5304 65.8657 46.1505 64.1757 45.8936 62.4034C45.1566 59.7313 44.5587 57.0228 44.1021 54.2887C43.3525 53.7393 43.0428 53.4285 42.1795 52.942C42.2791 55.3218 42.5956 57.6874 43.125 60.0097Z" stroke="url(#paint7_linear_549_352)" stroke-width="3"></path><path d="M47.3703 68.3773C48.2681 70.0195 49.2421 71.5886 50.2932 73.1374C51.2611 74.3105 52.2056 75.5018 53.1633 76.6819C52.8129 76.4128 52.5733 76.3132 52.4047 75.9436C51.5398 74.8834 50.7639 73.7536 50.085 72.5656C49.2115 71.3474 48.419 70.0731 47.7126 68.751C47.5541 68.6139 47.5602 68.4981 47.3703 68.3773Z" stroke="url(#paint8_linear_549_352)" stroke-width="3"></path><path d="M36.0408 40.4399C36.8776 43.8463 37.6658 47.2618 38.5138 50.6661C38.5349 53.1855 38.7611 55.699 39.1902 58.1816C38.1451 57.6626 36.9731 57.4301 35.8163 57.3519C33.9984 54.5163 32.1937 51.6736 30.3524 48.8532C30.6428 45.9781 31.0105 43.1211 31.4929 40.2713C33.0193 40.2368 34.5296 40.2328 36.0408 40.4399Z" stroke="url(#paint9_linear_549_352)" stroke-width="3"></path><path d="M30.4939 31.4C31.8274 34.0294 33.04 36.7065 34.1897 39.4233C35.8147 39.4426 37.4396 39.5025 39.0402 39.8224C39.7888 36.6266 40.7182 33.4758 41.824 30.3854C41.3111 27.1425 40.6348 23.9657 39.6537 20.8305C37.5392 21.4108 35.4325 22.0161 33.3335 22.6464C32.3281 25.5457 31.3815 28.4635 30.4939 31.4Z" stroke="url(#paint10_linear_549_352)" stroke-width="3"></path><path d="M23.9189 31.9301C25.6606 31.4914 27.4034 31.0628 29.1574 30.6769C30.0308 27.8332 30.9553 25.0037 31.931 22.1884C30.8665 20.3871 29.6859 18.6569 28.3967 17.0088L22.0298 20.6751C21.6344 22.5161 21.2387 24.3567 20.8426 26.197C21.9222 28.081 22.9408 29.9913 23.9189 31.9301Z" stroke="url(#paint11_linear_549_352)" stroke-width="3"></path><path d="M39.7583 40.7537C40.4774 44.1174 41.1527 47.4903 41.8819 50.8509C42.861 51.375 43.2154 51.7101 44.0675 52.3033C44.421 49.4768 45.1979 46.7601 46.1312 44.0768C46.2044 40.3668 46.3598 36.6629 46.4766 32.9508C45.1644 32.3669 43.8441 31.8418 42.4893 31.3695C41.3904 34.4396 40.4785 37.5734 39.7583 40.7537Z" stroke="url(#paint12_linear_549_352)" stroke-width="3"></path><path d="M44.4017 53.5169C44.759 56.2214 45.2598 58.905 45.9017 61.5564C46.5365 62.0642 46.9021 62.2978 48.0721 62.5172C48.3412 60.6607 48.8551 58.8996 49.4625 57.1294C49.0237 54.1425 48.8643 51.1708 48.8724 48.1504C47.8412 47.4924 46.9113 46.6877 46.112 45.7617C45.3188 48.3251 44.7257 50.854 44.4017 53.5169Z" stroke="url(#paint13_linear_549_352)" stroke-width="3"></path><path d="M41.2086 20.0516C41.9297 23.0984 42.406 26.1594 42.7493 29.2702C44.2108 29.7202 45.6326 30.2351 47.0575 30.7876C48.7597 27.5742 50.6203 24.4644 52.5855 21.4054C52.7825 17.9614 52.8424 14.5388 52.6058 11.0949C50.2475 11.0116 47.8923 10.9466 45.5331 10.9416C44.0472 13.9569 42.5929 16.9875 41.2086 20.0516Z" stroke="url(#paint14_linear_549_352)" stroke-width="3"></path><path d="M29.5778 15.4174C30.979 17.2406 32.2396 19.1677 33.3488 21.182C35.6556 20.3099 37.9681 19.4527 40.2864 18.6105C41.5728 15.9292 42.8955 13.2673 44.2544 10.6247C43.1556 8.61447 41.8193 6.74352 40.2742 5.05207C37.5869 6.41299 34.9003 7.77526 32.2143 9.13888C31.3396 11.2337 30.4607 13.3266 29.5778 15.4174Z" stroke="url(#paint15_linear_549_352)" stroke-width="3"></path><defs><linearGradient id="paint0_linear_549_352" x1="48.9221" y1="71.0275" x2="34.9372" y2="71.0275" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear_549_352" x1="33.7317" y1="61.7768" x2="21.2143" y2="61.7768" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint2_linear_549_352" x1="26.206" y1="48.1992" x2="17.2819" y2="48.1992" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint3_linear_549_352" x1="55.6831" y1="76.3234" x2="48.4103" y2="76.3234" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint4_linear_549_352" x1="49.6849" y1="66.2486" x2="39.7187" y2="66.2486" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint5_linear_549_352" x1="39.7329" y1="57.7525" x2="27.1282" y2="57.7525" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint6_linear_549_352" x1="33.5519" y1="40.6105" x2="22.496" y2="40.6105" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint7_linear_549_352" x1="47.1783" y1="60.2417" x2="42.1795" y2="60.2417" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint8_linear_549_352" x1="53.1633" y1="72.5296" x2="47.3703" y2="72.5296" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint9_linear_549_352" x1="39.1902" y1="49.2175" x2="30.3524" y2="49.2175" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint10_linear_549_352" x1="41.824" y1="30.3265" x2="30.4939" y2="30.3265" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint11_linear_549_352" x1="31.931" y1="24.4695" x2="20.8426" y2="24.4695" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint12_linear_549_352" x1="46.4766" y1="41.8364" x2="39.7583" y2="41.8364" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint13_linear_549_352" x1="49.4625" y1="54.1395" x2="44.4017" y2="54.1395" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint14_linear_549_352" x1="52.7596" y1="20.8646" x2="41.2086" y2="20.8646" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient><linearGradient id="paint15_linear_549_352" x1="44.2544" y1="13.117" x2="29.5778" y2="13.117" gradientUnits="userSpaceOnUse"><stop stop-color="#00DD82"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient></defs></svg></a><a href="/des" class="" data-v-fb5a971c><svg width="30px" height="30px" viewbox="0 0 81 81" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-fb5a971c data-v-2b6644a8><g clip-path="url(#clip0_290_333)"><path d="M54.45 45.34L58.99 35.51L39.5 17L20 35.51L24.62 45.44C26.06 48.53 26.34 52.02 25.43 55.3L23.51 62.2L27.45 63.29L29.37 56.39C30.54 52.17 30.17 47.68 28.33 43.71L24.77 36.05L37.87 23.33V43.25H41.37V23.57L54.24 36.06L50.75 43.63C48.89 47.66 48.55 52.23 49.79 56.5L51.78 63.32L55.7 62.17L53.71 55.35C52.74 52.03 53.01 48.48 54.46 45.34H54.45Z" fill="#00DD82"></path></g><defs><clipPath id="clip0_290_333"><rect width="39" height="46.31" fill="white" transform="translate(20 17)"></rect></clipPath></defs></svg></a><a href="/sec" class="" data-v-fb5a971c><svg width="30px" height="30px" viewbox="0 0 81 82" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-fb5a971c data-v-2b6644a8><g clip-path="url(#clip0_228_306)"><path d="M37.706 64.6439C37.9707 64.7523 38.2372 64.8562 38.5055 64.9555L38.5328 64.9664L38.5445 64.9722L38.5681 64.9805L38.5898 64.9892L38.6063 64.9939L39.2526 65.2204L39.5833 65.3363L39.9141 65.2204L40.5601 64.994L40.5623 64.9932L41.5062 64.6624L41.4935 64.6264C44.585 63.3499 47.5036 61.6871 50.1793 59.6771L50.1827 59.6745C54.9221 56.0824 60.1667 50.173 60.1667 41.6383V25.8542V25.1447L59.497 24.9103L39.9137 18.0561L39.5833 17.9405L39.253 18.0561L19.6696 24.9103L19 25.1447V25.8542V41.6403C19 50.1751 24.2487 56.0845 28.9819 59.6725L28.9851 59.6748C31.6694 61.6933 34.5991 63.3627 37.704 64.643L37.706 64.6439ZM39.5826 59.0168C37.0863 57.9521 34.7271 56.59 32.5562 54.9598C28.4831 51.8692 24.9167 47.4979 24.9167 41.6383V29.3445L39.5833 24.2111L54.25 29.3445V41.6383C54.25 47.4984 50.6829 51.8737 46.6105 54.9578C44.4392 56.5887 42.0794 57.9515 39.5826 59.0168Z" fill="#00DD82" stroke="black" stroke-width="2"></path></g><defs><clipPath id="clip0_228_306"><rect width="47" height="47" fill="white" transform="translate(17 19)"></rect></clipPath></defs></svg></a><a href="/book" class="" data-v-fb5a971c><svg width="30px" height="30px" viewbox="0 0 81 81" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon" data-v-fb5a971c data-v-2b6644a8><path d="M58.3589 17.5963C57.9742 17.2123 57.4514 17 56.9089 17H46.7003C45.2602 17 43.8399 17.3335 42.5577 17.9703C41.3642 18.5667 40.3187 19.4056 39.4803 20.4467C37.7936 18.3443 35.1897 17 32.2701 17H22.0516C21.5091 17 20.9863 17.2123 20.6017 17.5963C20.217 17.9804 20 18.506 20 19.0518V58.36C20 58.9058 20.217 59.4314 20.6017 59.8155C20.9863 60.1996 21.5091 60.4118 22.0516 60.4118H32.8915C33.5721 60.4118 34.2428 60.5432 34.8741 60.806C35.5053 61.0688 36.0675 61.4428 36.5508 61.9178L38.0501 63.4037C38.4347 63.7877 38.9575 64 39.5 64C40.0425 64 40.5652 63.7877 40.9499 63.4037L42.4492 61.9178C42.9325 61.4428 43.4947 61.0587 44.1259 60.806C44.7572 60.5432 45.4279 60.4118 46.1085 60.4118H56.9484C57.4909 60.4118 58.0137 60.1996 58.3983 59.8155C58.783 59.4314 59 58.9058 59 58.36V19.0518C59 18.506 58.783 17.9804 58.3983 17.5963H58.3589ZM37.4385 31.6357V57.4908C36.0478 56.7125 34.4795 56.2981 32.8816 56.2981H24.1032V21.1037H32.28C33.651 21.1037 34.9628 21.6495 35.9294 22.6097C36.8961 23.5699 37.4385 24.8839 37.4385 26.2383V31.6357ZM54.8574 56.2981H46.069C44.4712 56.2981 42.9127 56.7024 41.5319 57.4806V26.2383C41.5319 24.8738 42.0744 23.5699 43.041 22.6097C44.0076 21.6495 45.3194 21.1037 46.6904 21.1037H54.8475V56.3082L54.8574 56.2981Z" fill="#00DD82"></path><path d="M46.7003 17H56.9089C57.4514 17 57.9742 17.2123 58.3589 17.5963H58.3983C58.783 17.9804 59 18.506 59 19.0518V58.36C59 58.9058 58.783 59.4314 58.3983 59.8155C58.0137 60.1996 57.4909 60.4118 56.9484 60.4118H46.1085C45.4279 60.4118 44.7572 60.5432 44.1259 60.806C43.4947 61.0587 42.9325 61.4428 42.4492 61.9178L40.9499 63.4037C40.5652 63.7877 40.0425 64 39.5 64C38.9575 64 38.4347 63.7877 38.0501 63.4037L36.5508 61.9178C36.0675 61.4428 35.5053 61.0688 34.8741 60.806C34.2428 60.5432 33.5721 60.4118 32.8915 60.4118H22.0516C21.5091 60.4118 20.9863 60.1996 20.6017 59.8155C20.217 59.4314 20 58.9058 20 58.36V19.0518C20 18.506 20.217 17.9804 20.6017 17.5963C20.9863 17.2123 21.5091 17 22.0516 17H32.2701C35.1897 17 37.7936 18.3443 39.4803 20.4467C40.3187 19.4056 41.3642 18.5667 42.5577 17.9703C43.8399 17.3335 45.2602 17 46.7003 17ZM46.7003 17V17.2527M37.4385 31.6357V57.4908C36.0478 56.7125 34.4795 56.2981 32.8816 56.2981H24.1032V21.1037H32.28C33.651 21.1037 34.9628 21.6495 35.9294 22.6097C36.8961 23.5699 37.4385 24.8839 37.4385 26.2383V31.6357ZM54.8574 56.2981H46.069C44.4712 56.2981 42.9127 56.7024 41.5319 57.4806V26.2383C41.5319 24.8738 42.0744 23.5699 43.041 22.6097C44.0076 21.6495 45.3194 21.1037 46.6904 21.1037H54.8475V56.3082L54.8574 56.2981Z" stroke="#00DD82" stroke-width="0.5"></path></svg></a></main><!--[--><!--[--><div><main class="layout" data-v-3aa98d60><div class="book-info pc" data-v-3aa98d60><div class="book-info-home-img" data-v-3aa98d60><div class="no-img" data-v-3aa98d60></div><div class="book-info-author" data-v-3aa98d60><p data-v-3aa98d60>By James Forshaw</p><span data-v-3aa98d60>be reading 100%</span></div></div><div class="title" data-v-3aa98d60><p data-v-3aa98d60>Attacking Network Protocols:</p><span data-v-3aa98d60>A Hacker&#39;s Guide to Capture, Analysis, and Exploitation</span></div><div class="dir-layout" data-v-3aa98d60><p class="title" data-v-3aa98d60>directory</p><ul data-v-3aa98d60 data-v-e205a500><!--[--><!--]--></ul></div></div><div class="an" data-v-3aa98d60><div class="more" data-v-3aa98d60>Directory</div></div><!----><div class="main-con" data-v-3aa98d60><div class="text markdown-content" data-v-3aa98d60><!--[--><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="title" data-v-f0803dcc>Google Project Zero</p></main></div><h1 id="作者-1"><!--[-->作者 1<!--]--></h1><p><!--[-->本书的作者是 <a href="https://github.com/tyranid" rel="nofollow"><!--[-->James Forshaw<!--]--></a>，也是著名的 <a href="https://googleprojectzero.blogspot.com/" rel="nofollow"><!--[-->Google Project Zero<!--]--></a> 成员之一。他负责维护很多开源的分析工具，同时自己也根据多年的经验总结出自己想要的工具。并在一些会议中分享，甚至是 open source。到目前，他已经是一位高级猎食者，从当初的破解游戏机，到揭秘操作系统中的复杂问题，具有十余年应用网络协议分析、利用经验。<!--]--></p>




















<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->会议<!--]--></th><th><!--[-->描述<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[--><a href="https://www.blackhat.com/" rel="nofollow"><!--[-->BlackHat<!--]--></a><!--]--></td><td><!--[-->国际公认的网络安全活动系列，提供最具技术性和相关性的信息安全研究<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><a href="https://www.secwest.net/" rel="nofollow"><!--[-->CanSecWest<!--]--></a><!--]--></td><td><!--[-->加拿大著名的国际信息安全会议，负责举办 Pwn2Own<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><a href="https://events.ccc.de/" rel="nofollow"><!--[-->Chaos Computer Conference<!--]--></a><!--]--></td><td><!--[-->由德国 CCC 组织，以其独特的社区文化、技术讨论和社会议题探讨而闻名<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->作者的经历非常 Nice! 有一个良好的家庭，无论做什么都鼓励孩子的家长。走入职场有 Richard Nea 这样不内耗的好 <a href="https://en.wikipedia.org/wiki/Line_management" rel="nofollow"><!--[-->Leader(line manager)<!--]--></a> 同时发现了作者对 Security 领域有浓厚的兴趣并符合其性格。<!--]--></p><main class="text-tip"><!--[--><p><!--[-->直线领导(Line manager) 通常指的是直接参与工作并需要对同事工作负责的领导，通常负责指导同事能在特定的职能领域下完成团队或公司的目标。<!--]--></p><!--]--></main><p><!--[-->在规划职业路径阶段认识了 <a href="https://www.linkedin.com/in/mike-jordon-72193719/" rel="nofollow"><!--[-->Mike Jordon<!--]--></a> 在初创阶段进入到了 Context Information Security。与公司的创始团队学习，并培养其网络协议分析方面的技能，并开发了 Canape 等工具。这些不内耗的好 Leader，给了其充足的时间进行有前途的安全研究。<!--]--></p><main class="text-tip"><!--[--><p><!--[-->2020 年 3 月，世界 500 TOP 之一的 NYSE: ACN 已收购领先的网络防御咨询公司 Context Information Security，该公司之前由母公司 Babcock International Group 所有。Context 成立于 1998 年，总部位于伦敦，是英国和全球金融服务领域最知名、最受尊敬的信息安全服务提供商之一。该公司提供高端网络防御、情报驱动的红队、漏洞研究和事件响应服务。他们曾参与处理业内一些最先进的事件响应案例。<!--]--></p><p><!--[-->Mike Jordon 曾经是 Context 的首席信息顾问，自 2020 年起为 Airis Security Technologies 的首席技术官。<!--]--></p><!--]--></main><hr><p><!--[-->我之所以阅读这本书，是因为在我的生活中，几乎还未遇到和协议有关的事情（除了一些常见的场景，如 burp、nmap 这些基础的，或者一些涉及到流量分析的题目）。虽然我见过通过 Wireshark 来调试 API 的，但我认为这些远远不是 Wireshark 的全部功能。<!--]--></p><p><!--[-->在本书中虽然几乎都是用作者所开发的 Canape ，还包括了很多网络协议工具包，这些工具很多都是家喻户晓的，但成体系和系统性的学习，是我经历所缺少的部分。同时也希望提升自己在网络协议上面的见解，并扩充下眼界。<!--]--></p><hr><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="title" data-v-f0803dcc>协议是一切的基础</p></main></div><h1 id="基础-2"><!--[-->基础 2<!--]--></h1><p><!--[-->&quot;对常见网络的构建和功能了解得越多，就越容易将这些知识应用于捕获、分析和利用新协议。&quot; 这句话出在第一章的概述，小时候。我就对 IETF 非常崇拜，并不是因为他们的宣传，而是朴实无华的运行风格。<!--]--></p><p><!--[-->还记得第一次看到 IETF 的出版物，被 RFC 的简洁所震撼。这种朴实无华的风格，不仅简洁还充满了复古风味内容也相当丰富，记录了一个协议和提案标准的各类信息。以及协议提案的流程，该提案所经aaaa历过的所有环节依次公开。<!--]--></p><p><!--[-->一个标准的协议具有很多或很少的功能，但他们几乎或多或少符合下面六项特点中的一项：<!--]--></p>
































<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->功能<!--]--></th><th><!--[-->描述<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->维护会话状态<!--]--></td><td><!--[-->创建新的连接或终止连接<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->通过寻址识别节点<!--]--></td><td><!--[-->数据需要传输到对应的节点，因此协议通过寻址来识别特定的节点或组<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->控制流量<!--]--></td><td><!--[-->一次性通过网络传输的量是有限的。协议通过实施管理数据流，以提高吞吐减少延迟<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->保证传输数据的顺序<!--]--></td><td><!--[-->将发送和接收到分散且混乱的数据重新排序，以保证数据的正确顺序<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->检测和纠正错误<!--]--></td><td><!--[-->网络不是 100% 可靠的;数据可能会损坏。检测损坏并理想情况下纠正它非常重要<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->格式化和编码数据<!--]--></td><td><!--[-->数据并不适合在网络中传输，例如将英语文本编码为二进制值；协议可以指定对数据进行编码甚至加密<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->我们都了解很多传输协议，这些协议是基础的。但很多时候，这些协议都是背后的一条条数据流，我们浏览网页，使用 APP 不需要思考这些是如何进行的，死记硬背不仅内耗自己，还花了很多时间，但在工作中几乎只有面试时才会用到。而基础章节中，作者总结出了自己的一套模型：<!--]--></p><!--[--><pre class="language-text" style=""><!--[--><code>┌──────────────────────────────┐
│        Protocol model        │
│                              │
│  ┌────────────────────────┐  │
│  │     Content layer      │  │   I would like to get the file image.png
│  │     (File request)     │  │
│  └───────────▲────────────┘  │
│              │               │
│  ┌───────────▼────────────┐  │
│  │     Encoding layer     │  │   GET /image.png HTTP/1.1
│  │         (HTTP)         │  │
│  └───────────▲────────────┘  │
│              │               │
│  ┌───────────▼────────────┐  │
│  │    Transport layer     │  │   4500 0043 50d1 4000 8000 c0a8 0a6d
│  │        (TCP/IP)        │  │   d83a d544 40e0 0050 5dff a4e6 6ac2
│  └────────────────────────┘  │   ……
│                              │
└──────────────────────────────┘
</code><!--]--></pre><!--]-->




















<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->协议模型<!--]--></th><th><!--[-->描述<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->内容层 (文件请求)<!--]--></td><td><!--[-->我想要一个 image.png 图片<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->编码层 (HTTP)<!--]--></td><td><!--[-->GET /image.png HTTP/1.1<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->传输层 (TCP/IP)<!--]--></td><td><!--[-->4500 0043 50d1 4000 8000 c0a8 0a6d <br> d83a d544 40e0 0050 5dff a4e6 6ac2 ……<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->作者的这套网络模型，几乎概述了传输所涵盖的三个特点，即内容、寻址、传输等三个功能的概念化，因此适用于总结或对一个陌生的协议时的理解步骤。毕竟协议是可以自定义的，例如通过 Matrix 就可以自定义一个通信协议。<!--]--></p><main class="text-tip"><!--[--><p><!--[-->&quot;以这种方式拆分模型可以降低特定于应用程序的协议的复杂性，因为它允许我们过滤掉不相关的网络协议详细信息。例如，因为我们并不真正关心 TCP/IP 是如何发送到远程节点的（我们理所当然地认为它会以某种方式到达那里），所以我们只是将 TCP/IP 数据视为正常工作的二进制传输。&quot;<!--]--></p><!--]--></main><p><!--[-->这一章节非常有意思，可以看一下原文 第一章：My Model for Network Protocol Analysis，给出了很多贴近该模型的案例。作者是一个不内耗的人，不会解说一堆 RFC 文件和 Wikipedia 中的内容，仅列举其作用和描述，让读者感兴趣的地方可以深入了解，并得出自己的见解。<!--]--></p><hr><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="title" data-v-f0803dcc>流量捕获</p></main></div><h1 id="捕获-2"><!--[-->捕获 2<!--]--></h1><p><!--[-->针对流量的捕获分为主动和被动捕获，他们分别在不同的场景有不同的用处，对于主动捕获，甚至可以进行中间人攻击，如经常用到的 Burp Suite。<!--]--></p>



















<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->名称<!--]--></th><th><!--[-->描述<!--]--></th><th><!--[-->特点<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->被动捕获<!--]--></td><td><!--[-->在线路上传输时提取数据，如 Wireshark<!--]--></td><td><!--[-->不直接与流量交互<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->主动捕获<!--]--></td><td><!--[-->干扰客户端应用程序与服务器之间的流量，类似 Burp 中通过代理进行拦截。<!--]--></td><td><!--[-->直接与服务器之间的流量产生干扰甚至是拦截、篡改<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->除了 Wireshark 和 Burp，还有很多针对不同场景下会使用的工具，这里作者列举了几个我很感兴趣的场景，是不适用于被动捕获的：<!--]--></p><ol><!--[--><li><!--[-->在没有管理访问权限的系统或具有有限权限 shell 的移动设备上执行审计<!--]--></li><li><!--[-->只查看正在测试的应用程序的流量<!--]--></li><!--]--></ol><p><!--[-->作者演示了通过各种工具，从系统的工作原理来实现如何从本地应用程序提取网络流量的演示，这是我非常感兴趣的。其中有很多涉及到了操作系统原理和设计，想必这就是为什么要学操作系统设计和原理吧。<!--]--></p><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>系统调用跟踪</p></main></div><p><!--[-->许多现代系统提供了两种执行模式，分别为用户模式和内核模式。以提高系统的稳定性和安全性，保护系统免受不可信用户代码的影响。我体验过 Windows、Macos、Linux 这三个生态的系统，我的感受就是。<!--]--></p>

















































<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->模式<!--]--></th><th><!--[-->描述<!--]--></th><th><!--[-->特点<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->用户模式<!--]--></td><td><!--[-->操作系统普通应用程序和用户空间进程运行的模式<!--]--></td><td><!--[-->权限限制<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->隔离<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->限制对系统资源的直接访问<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->日常应用程序的运行<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->内核模式<!--]--></td><td><!--[-->操作系统核心代码，具有对系统资源的完全访问权限<!--]--></td><td><!--[-->完全权限<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->关键操作<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->直接访问和控制系统资源<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->系统级调用<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><main class="text-tip"><!--[--><p><!--[-->总结来说，内核模式以高权限运行，并包含实现操作系统核心功能的代码。用户模式是运行日常流程的地方，内核通过导出一组特殊系统调用为用户模式提供服务，允许用户访问文件、创建进程。<!--]--></p><!--]--></main><p><!--[-->在 Windows 系统中，你是 Administrators；在 Linux 中，你是 Developers；而在 macOS 中，你只是一个普普通通的 User。这是我对这三个生态中系统执行模式的切身感受。<!--]--></p><!--[--><pre class="" style=""><!--[--><code>┌─────────────────────────────────────────────────┐                                 
│                                                 │                      ┌──────   ┐
│                                                 │                      │       S │
│   ┌────────────────────────┬────────────────┐   │                      │       e │
│   │                        │    Network     │   │                      │       r │
│   │         Kernel         │   subsystem    │◀──┼─────  Network  ──────┤       v │
│   │                        │                │   │                      │       i │
│   └────────────────────────┴─────────────▲──┘   │                      │       c │
│                                          │      │                      │       e │
│                                          │      │                      └──────   ┘
│                                                 │                                 
│                                          S      │                                 
│                                          y      │                                 
│                                          s      │                                 
│                                          t      │                                 
│                                          e      │                                 
│   ──────────   Kernel/User model    ──── m      │                                 
│                                                 │                                 
│                                          c      │                                 
│                                          a      │                                 
│                                          l      │                                 
│                                          l      │                                 
│                                                 │                                 
│                                          │      │                                 
│                                          │      │                                 
│   ┌──────────────────────────────────────┴──┐   │                                 
│   │                                         │   │                                 
│   │             System libraies             │   │                                 
│   │                                         │   │                                 
│   ├─────────────────────────────────────────┤   │                                 
│   │                                         │   │                                 
│   │                                         │   │                                 
│   │           Client application            │   │                                 
│   │                                         │   │                                 
│   │                                         │   │                                 
│   └─────────────────────────────────────────┘   │                                 
│                                                 │                                 
│                                                 │                                 
└─────────────────────────────────────────────────┘                                 
</code><!--]--></pre><!--]--><p><!--[-->当应用程序想要连接远程服务器时，应用程序会向操作系统内核发出系统调用以打开连接。之后应用程序读取和写入网络数据，因此我们可以通过监测这之间的过程，而实现对目标应用程序的网络捕获，作者给出了一个非常通俗易懂的图，简单的概括了这其中的一系列过程，简洁明了。<!--]--></p><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>网络编程的基础</p></main></div><p><!--[-->大多时候，我们在学习各类 code 语言的时。或多或少都会接触网络编程，比如耳熟能详的 Socket。这就要说到 IP 协议的首个实现是在 <a href="https://en.wikipedia.org/wiki/Berkeley_Software_Distribution" rel="nofollow"><!--[-->Berkeley Software Distribution（BSD）<!--]--></a> 完成的。因此在网络通信领域中，就离不开 <a href="https://en.wikipedia.org/wiki/Berkeley_sockets" rel="nofollow"><!--[-->Berkeley Sockets<!--]--></a>，它作为网络编程的基础，提供了不同主机之间进行网络通信的标准接口。<!--]--></p><main class="text-tip"><!--[--><p><!--[-->如果你是类 Unix 系统，可以在终端输入 <code class=""><!--[-->man 2 syscall_name<!--]--></code> 在终端中查看手册，比如 <code class=""><!--[-->man 2 open<!--]--></code> 就可以查看系统调用第二章有关 open 的内容。<!--]--></p><!--]--></main><p><!--[-->它主要定义了一系列的系统调用，允许应用程序通过网络发送和接收数据。广为人知的就是 close()、connect()、socket()、listen()、send(), 这些 Berkeley_sockets 被纳入 POSIX 标准的一部分。<!--]--></p><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>不同平台之间的捕获</p></main></div>
























<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->平台<!--]--></th><th><!--[-->应用<!--]--></th><th><!--[-->描述<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->Linux<!--]--></td><td><!--[-->Strace<!--]--></td><td><!--[-->跟踪系统调用和信号<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->macOS<!--]--></td><td><!--[-->DTrace<!--]--></td><td><!--[-->跟踪系统调用, 可用于许多类 Unix 系统<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->Windows<!--]--></td><td><!--[-->Process Monitor<!--]--></td><td><!--[-->Windows TEAM 提供的交互非常 Nice 的进程监视器<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><main class="text-tip"><!--[--><p><!--[-->与类 Unix 系统相比，Windows 无需直接系统调用即可实现其用户模式网络功能。网络堆栈通过驱动程序公开，建立连接使用文件 open、read 和 write 系统调用来配置网络套接字以供使用。即使 Windows 支持类似于 strace 的工具，此实现也会使得在与其他平台相同的级别监视网络流量变得更加困难。<!--]--></p><p><!--[-->从 Vista 及更高版本开始，Windows 支持事件生成框架，该框架允许应用程序监视网络活动。编写自己的实现会相当复杂，但幸运的是，已经有人编写了一个工具来为你做这件事：Microsoft 的进程监视器工具。<!--]--></p><p><!--[-->尽管此解决方案不如监视其他平台上的系统调用有用，但当您只想确定特定应用程序正在使用的网络协议时，它在 Windows 中仍然很有用。您无法使用此技术捕获数据，但一旦确定了正在使用的协议，就可以通过更活跃的网络流量捕获将该信息添加到分析中。<!--]--></p><!--]--></main><p><!--[-->让我意外的是，Microsoft 的进程监视工具非常方便，它提供了应用程序在建立网络通信时的必要信息。同时还能捕获当前调用堆栈的状态，以确定在应用程序中建立网络连接的位置。对二进制文件进行逆向工程以制定网络协议时，这将变得很重要。<!--]--></p><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>主动捕获</p></main></div><p><!--[-->&quot;主动捕获可能是分析和利用应用程序网络协议最有价值的技术&quot;，这一章节告诉我们，编写一个属于自己的网络代理有多么重要。这个程序要实现流量重定向到代理，同时以更加可观的形式输出 (虽然作者提供了自己写的代理库，但已经年久失修了)。<!--]--></p><h1 id="太阳底下没有新鲜事-3"><!--[-->太阳底下没有新鲜事 3<!--]--></h1><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="title" data-v-f0803dcc>太阳底下没有新鲜事</p></main></div><p><!--[-->开篇作者直接抛出了一句谚语：“太阳底下没有新鲜事 (There is nothing new under the sun)” 并告诉读者这句谚语在协议结构方式方面非常适用。二进制和文本协议遵循常见的模式和结构，一旦理解，就可以很容易地应用于任何新协议。<!--]--></p><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>一些进制的基础</p></main></div><p><!--[-->我属于是那种从来没有体系过学习的，之前读书的时候还会自己算一下 16 进制，但现在也都忘记了。很庆幸的是作者给出了非常清晰易懂的描述，以及图文结合的方式讲解二进制协议的结构。<!--]--></p>












































<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->类型<!--]--></th><th><!--[-->描述<!--]--></th><th><!--[-->特点<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->二进制协议<!--]--></td><td><!--[-->以二进制格式传输数据<!--]--></td><td><!--[-->高效性<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->紧凑性<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->复杂性<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->依赖性<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->文本协议<!--]--></td><td><!--[-->以人类可读的形式传输数据（如 ASCII 或 UTF-8）<!--]--></td><td><!--[-->可读性<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->效率低<!--]--></td><!--]--></tr><tr><!--[--><td><!--[--><!--]--></td><td><!--[--><!--]--></td><td><!--[-->灵活性（容错性和可扩展性）<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><p><!--[-->我们都知道二进制就是 0 和 1，处理单个位很难，因此在计算机中。通常以八位(Bit)为一组，8 bit 即一个字节(byte). 在网络和通信中，通常使用 <code class=""><!--[-->octet<!--]--></code> 来确保每个单位确实是 8 位。<!--]--></p><main class="text-tip"><!--[--><p><!--[-->八位字节是网络协议的实际单元。尽管八位字节可以分解为单个位（例如，表示一组标志），但我们将以 8 位单位处理所有网络数据<!--]--></p><!--]--></main><!--[--><pre class="" style=""><!--[--><code>                                                                
                  Bit 7/MSB                                     
                                                                
                   ^                                            
                   |                                            
                 +---+---+---+---+---+---+---+---+              
  Bit format:    | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 |   = 0x41/65  
                 +---+---+---+---+---+---+---+---+              
                                               |                
                                               v                
                                                                
 Octet format: 0x41                      Bit 0/LSB              
                                                                
</code><!--]--></pre><!--]--><p><!--[-->首先我们要做的就是，区分位编号方向。如果没有特殊说明,应该按照从左到右的方式来读取位编号。即最高有效位（MSB）在左侧，最低有效位（LSB）在右侧。这种方式是最常见的（常见于大多数计算机体系结构，如 x86 和 ARM）<!--]--></p><main class="text-tip"><!--[--><p><!--[-->当然也有从右到左的，比如 PowerPC 就使用这样的。最高有效位（MSB）位于右侧，最低有效位（LSB）位于左侧。<!--]--></p><!--]--></main><div class="text-title-color" data-v-f0803dcc><main data-v-f0803dcc><p class="h2" data-v-f0803dcc>数值数据</p></main></div><p><!--[-->数值数据就是表示数字的数据值，是指适用不同的方式存储或描述一个数字。比如上图就将二进制，以十进制和十六进制的方式表达。0x41 是这个二进制数的十六进制表示方法;65 是这个二进制数的十进制表示方法。<!--]--></p><p><!--[-->这些基础的知识有很多，甚至有的人可以口算，而不需要用到转换器。但在大模型发展的今天，我们只需要 copy 就可以知道其中的信息甚至帮我们翻译成人类可读的形式。再加上 Wireshark 也会帮我们将一些人类不可读的进制转换成十六进制，也会将一些未使用加密的传输暴露在阳光之下。因此我认为全书重要的信息是，<strong><!--[-->协议结构<!--]--></strong> 与逆向。<!--]--></p><p><!--[-->前者可以知道这是什么协议魔改的，后者可以通过逆向工程知道其运转的逻辑，从而找出问题所在。也就是说，我们当看到一个 Wireshark 中看到一个流量请求中，要根据其 Type 来识别出该协议的具体 <strong><!--[-->握手过程<!--]--></strong> 来识别出加密套件。<!--]--></p><p><!--[-->之后，我们需要通过逆向工程不断的进行断点，以及指令的输出。观看程序的变化以及影响，结合 OWASP 常见漏洞进行分析，以发现程序的弱点与信息的变化。我想我会从 The IDA Pro Book 这本书中找到我想要的。<!--]--></p><!--]--></div></div></main></div><!--]--><!--]--></div></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/book/attacking-network-protocols/_payload.json?cc738484-d7be-44c9-898c-02eb7dab1201">[{"state":1,"once":12,"_errors":14,"serverRendered":5,"path":17,"prerenderedAt":18},["Reactive",2],{"$scolor-mode":3,"$sicons":7,"$ssite-config":8},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{},{"env":9,"name":10,"url":11},"production","iusx","https://m.ritsu.jiangxue.org/",["Reactive",13],["Set"],["Reactive",15],{"content-query-SBsbQ6yWni":16},null,"/book/attacking-network-protocols",1750962051593]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1750962025604,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:false,wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>