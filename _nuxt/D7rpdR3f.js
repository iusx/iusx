import{_ as S}from"./TobpDjZo.js";import{_ as E}from"./B2IJqHrQ.js";import{u as k}from"./B0bVMbzi.js";import{u as F,q as L}from"./wF1vCJCt.js";import{_ as V}from"./Dk98_6OW.js";import{y as $,k as B,b as I,N as M,A as l,O as a,P as v,G as N,R as q,Y as b,X as x,u as z,z as g,H as i,B as w,C,Z as U,_ as W}from"./Dh2Oq3Os.js";import"./CTkMQdwY.js";const Y=p=>(U("data-v-ed8162aa"),p=p(),W(),p),j={class:"hi"},G=Y(()=>a("span",null,"MY plan",-1)),H={class:"layout-box"},Q={class:"title-box"},R={class:"title-box_name"},X={class:"title"},Z={class:"plan-box"},J=["href"],K={class:"title"},O={class:"plan-box"},P={__name:"plan",async setup(p){let _,f;k({title:"PLAN"});const{data:T}=([_,f]=$(()=>F("equalLink",()=>L("plan/").find())),_=await _,f(),_),u=t=>t.toLocaleString(),d=(t,n=null)=>{const s=n?n.displayType:t.displayType;return s==="usd"?{target:`SAVE ${u(t.target)} USD`,current:`NOW: ${u(t.current)} USD`}:s==="percent"?{target:`SAVE ${u(t.target)}%`,current:`NOW: ${u(t.current)}%`}:{target:`SAVE ${u(t.target)}`,current:`NOW: ${u(t.current)}`}},m=B(()=>{const t=T.value||[],n=new Map;t.forEach(e=>{const r=String(e._path||"").split("/").filter(Boolean);if(r.length<2)return;const o="/"+r.slice(0,2).join("/");if(r.length===2)n.set(o,{...e,_path:o,subPlans:[]});else{if(!n.has(o)){const h=r[1].replace(/[-_]/g," ").replace(/\b\w/g,A=>A.toUpperCase());n.set(o,{title:h,_path:o,target:0,current:0,progress:0,barClass:"",displayType:e.displayType||"percent",time:null,subPlans:[]})}n.get(o).subPlans.push({...e})}});for(const e of n.values())if((!e.target||e.target===0)&&e.subPlans.length&&(e.target=e.subPlans.reduce((r,o)=>r+(Number(o.target)||0),0)),e.current=e.current?Number(e.current):e.subPlans.reduce((r,o)=>r+(Number(o.current)||0),0),!e.displayType&&e.subPlans.length&&(e.displayType=e.subPlans[0].displayType||"percent"),!e.time&&e.subPlans.length){let r=0;e.subPlans.forEach(o=>{const c=new Date(o.time).getTime();!isNaN(c)&&c>r&&(r=c)}),e.time=r?new Date(r).toISOString():null}const s=Array.from(n.values());return s.sort((e,r)=>{const o=e.time?new Date(e.time).getTime():0;return(r.time?new Date(r.time).getTime():0)-o}),s}),D=m,y=()=>{(m.value||[]).forEach(t=>{t.target=Number(t.target)||0,t.current=Number(t.current)||0;const n=t.target===0?0:t.current/t.target*100;t.progress=parseFloat(n.toFixed(2)),t.barClass=t.current<t.target?"progress-positive":"progress-negative",(t.subPlans||[]).forEach(s=>{s.target=Number(s.target)||0,s.current=Number(s.current)||0;let e=0;t.current===0||t.target===0?e=t.target===0?0:s.current/t.target*100:s.current>t.current?(e=(s.current-t.current)/t.current*100,t.barClass="progress-negative",s.barClass="progress-negative"):(e=s.current/t.target*100,s.barClass=s.current<t.target?"progress-positive":"progress-negative"),s.progress=Math.min(100,parseFloat((Number.isFinite(e)?e:0).toFixed(2)))})})};return I(m,()=>{y()},{immediate:!0,deep:!0}),M(()=>{y()}),(t,n)=>{const s=S,e=E;return g(),l("main",null,[a("div",j,[a("h1",null,[v(s),N(),v(e,null,{default:q(()=>[N("PLAN")]),_:1})]),G]),a("div",H,[(g(!0),l(b,null,x(z(D),(r,o)=>(g(),l("div",{key:o,class:"layout"},[a("div",Q,[a("p",R,i(r.title),1),a("div",X,[a("p",null,i(d(r).target),1),a("span",null,i(d(r).current),1)])]),a("div",Z,[a("div",{class:w(["progress-bar",r.barClass]),style:C({width:r.progress+"%"})},[a("p",null,i(r.progress)+"%",1)],6)]),(g(!0),l(b,null,x(r.subPlans,(c,h)=>(g(),l("a",{href:c._path,key:h,class:"sub-plan"},[a("div",K,[a("p",null,i(d(c,r).target)+" - "+i(c.title),1),a("span",null,i(d(c,r).current),1)]),a("div",O,[a("div",{class:w(["progress-bar",c.barClass]),style:C({width:c.progress+"%"})},[a("p",null,i(c.progress)+"%",1)],6)])],8,J))),128))]))),128))])])}}},nt=V(P,[["__scopeId","data-v-ed8162aa"]]);export{nt as default};
