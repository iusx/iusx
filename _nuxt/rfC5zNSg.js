import{_ as S}from"./DpFs2FAD.js";import{_ as E}from"./CySjG9KU.js";import{u as k}from"./BmFGX7ah.js";import{u as F,q as L}from"./DKb-_EYB.js";import{_ as V}from"./DIw-05zE.js";import{y as $,k as B,b as I,N as M,A as l,O as o,P as v,G as N,R as q,Y as b,X as x,u as z,z as g,H as i,B as w,C,Z as U,_ as W}from"./Dh2Oq3Os.js";import"./DHFmAq2r.js";const Y=p=>(U("data-v-69ee04e5"),p=p(),W(),p),j={class:"hi"},G=Y(()=>o("span",null,"MY plan",-1)),H={class:"layout-box"},Q={class:"title-box"},R={class:"title-box_name"},X={class:"title"},Z={class:"plan-box"},J=["href"],K={class:"title"},O={class:"plan-box"},P={__name:"plan",async setup(p){let _,f;k({title:"PLAN"});const{data:T}=([_,f]=$(()=>F("equalLink",()=>L("plan/").find())),_=await _,f(),_),u=e=>e.toLocaleString(),d=(e,n=null)=>{const s=n?n.displayType:e.displayType;return s==="usd"?{target:`SAVE ${u(e.target)} USD`,current:`NOW: ${u(e.current)} USD`}:s==="percent"?{target:`SAVE ${u(e.target)}%`,current:`NOW: ${u(e.current)}%`}:{target:`SAVE ${u(e.target)}`,current:`NOW: ${u(e.current)}`}},m=B(()=>{const e=T.value||[],n=new Map;e.forEach(t=>{const r=String(t._path||"").split("/").filter(Boolean);if(r.length<2)return;const a="/"+r.slice(0,2).join("/");if(r.length===2)n.set(a,{...t,_path:a,subPlans:[]});else{if(!n.has(a)){const h=r[1].replace(/[-_]/g," ").replace(/\b\w/g,A=>A.toUpperCase());n.set(a,{title:h,_path:a,target:0,current:0,progress:0,barClass:"",displayType:t.displayType||"percent",time:null,subPlans:[]})}n.get(a).subPlans.push({...t})}});for(const t of n.values())if((!t.target||t.target===0)&&t.subPlans.length&&(t.target=t.subPlans.reduce((r,a)=>r+(Number(a.target)||0),0)),t.current=t.current?Number(t.current):t.subPlans.reduce((r,a)=>r+(Number(a.current)||0),0),!t.displayType&&t.subPlans.length&&(t.displayType=t.subPlans[0].displayType||"percent"),!t.time&&t.subPlans.length){let r=0;t.subPlans.forEach(a=>{const c=new Date(a.time).getTime();!isNaN(c)&&c>r&&(r=c)}),t.time=r?new Date(r).toISOString():null}const s=Array.from(n.values());return s.sort((t,r)=>{const a=t.time?new Date(t.time).getTime():0;return(r.time?new Date(r.time).getTime():0)-a}),s}),D=m,y=()=>{(m.value||[]).forEach(e=>{e.target=Number(e.target)||0,e.current=Number(e.current)||0;const n=e.target===0?0:e.current/e.target*100;e.progress=parseFloat(n.toFixed(2)),e.barClass=e.current<e.target?"progress-positive":"progress-negative",(e.subPlans||[]).forEach(s=>{s.target=Number(s.target)||0,s.current=Number(s.current)||0;let t=0;e.current===0||e.target===0?t=e.target===0?0:s.current/e.target*100:s.current>e.current?(t=(s.current-e.current)/e.current*100,e.barClass="progress-negative",s.barClass="progress-negative"):(t=s.current/e.target*100,s.barClass=s.current<e.target?"progress-positive":"progress-negative"),s.progress=Math.min(100,parseFloat((Number.isFinite(t)?t:0).toFixed(2)))})})};return I(m,()=>{y()},{immediate:!0,deep:!0}),M(()=>{y()}),(e,n)=>{const s=S,t=E;return g(),l("main",null,[o("div",j,[o("h1",null,[v(s),N(),v(t,null,{default:q(()=>[N("PLAN")]),_:1})]),G]),o("div",H,[(g(!0),l(b,null,x(z(D),(r,a)=>(g(),l("div",{key:a,class:"layout"},[o("div",Q,[o("p",R,i(r.title),1),o("div",X,[o("p",null,i(d(r).target),1),o("span",null,i(d(r).current),1)])]),o("div",Z,[o("div",{class:w(["progress-bar",r.barClass]),style:C({width:r.progress+"%"})},[o("p",null,i(r.progress)+"%",1)],6)]),(g(!0),l(b,null,x(r.subPlans,(c,h)=>(g(),l("a",{href:c._path,key:h,class:"sub-plan"},[o("div",K,[o("p",null,i(d(c,r).target)+" - "+i(c.title),1),o("span",null,i(d(c,r).current),1)]),o("div",O,[o("div",{class:w(["progress-bar",c.barClass]),style:C({width:c.progress+"%"})},[o("p",null,i(c.progress)+"%",1)],6)])],8,J))),128))]))),128))])])}}},ne=V(P,[["__scopeId","data-v-69ee04e5"]]);export{ne as default};
